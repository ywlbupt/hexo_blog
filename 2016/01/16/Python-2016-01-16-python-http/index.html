<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>python-http | WiZero</title>
  <meta name="author" content="Wlin">
  
  <meta name="description" content="[Python][Spider][urllib]HTTP-urlib@(3.09 - Python)[python, urllib, spider]
注:  

  python 3.x中urllib库和urilib2库合并成了urllib库。    其中urllib2.urlopen()变成了ur">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="python-http"/>
  <meta property="og:site_name" content="WiZero"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  <link rel="alternate" href="/hexo_blog/atom.xml" title="WiZero" type="application/atom+xml">
  <link rel="stylesheet" href="/hexo_blog/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <meta name="wumiiVerification" content="fb50a101-84fe-4ca2-91a7-ae8cf792978b" />
  
  <meta name="wumiiVerification" content="d73b5866-c390-4156-a4dd-51b526b5335e" />
</head>

<body>
  <header id="header">
<div class= "header-content inner">
	<div class = "alignleft col-one">
		
			<div class='avatar'>
				<img src = "/hexo_blog/images/site/lufy-avatar.jpg">
              </div>
		
		<div class="header-div">
		    <h1><a href="/hexo_blog/">WiZero</a></h1>
		    <h2><a href="/hexo_blog/">阅读，思考，实践，不忘初心</a></h2>
		</div>
	</div>
	<div class = "alignright col-two">
		
	</div>
	<div class="clearfix"></div>
</div>

<div class= "header-nav">
	<div class='header-nav-content inner'>
		<div id="main-nav" class="alignleft">
			<ul>
		    		
		    		  <li><a href="/hexo_blog/./">首页</a></li>
		    		
		    		  <li><a href="/hexo_blog/archives">归档</a></li>
		    		
		    	</ul>
		</div>
		<div id="sub-nav" class="alignright">
     	 <ul>
		    
		      <li><a href="/hexo_blog/atom.xml">订阅</a></li>
		    
		      <li><a href="/hexo_blog/customization">留言</a></li>
		    
     	 </ul>
		</div>
	</div>
	<div class="clearfix"></div>
</div>
</header>
  
    <div id="content" class="inner">
      <div id="main-col" class="alignleft"><div id="wrapper">
    
      <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> post </strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Python-Spider-urllib-HTTP-urlib"><span class="toc-number">1.</span> <span class="toc-text">[Python][Spider][urllib]HTTP-urlib</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#POST和GET请求"><span class="toc-number">1.1.</span> <span class="toc-text">POST和GET请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#User-Agent"><span class="toc-number">1.2.</span> <span class="toc-text">User-Agent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie"><span class="toc-number">1.3.</span> <span class="toc-text">Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Proxy-代理-ProxyHandler"><span class="toc-number">1.4.</span> <span class="toc-text">Proxy 代理 ProxyHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模拟浏览器-POST-GET-方式"><span class="toc-number">1.5.</span> <span class="toc-text">模拟浏览器 POST GET 方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllib库"><span class="toc-number">1.6.</span> <span class="toc-text">urllib库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#urllib-request-urlopen"><span class="toc-number">1.6.1.</span> <span class="toc-text">urllib.request.urlopen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#urllib-request-Request"><span class="toc-number">1.6.2.</span> <span class="toc-text">urllib.request.Request</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#urllib-request-urlopen-Request-示例代码"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">urllib.request.(urlopen,Request)示例代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常见用法"><span class="toc-number">1.7.</span> <span class="toc-text">常见用法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#直接将URL保存为本地文件："><span class="toc-number">1.7.1.</span> <span class="toc-text">直接将URL保存为本地文件：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#打印HTTP-header"><span class="toc-number">1.7.2.</span> <span class="toc-text">打印HTTP header</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference-Link"><span class="toc-number">2.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

      
  

      
<article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2016-01-16T08:18:05.000Z"><a href="/hexo_blog/2016/01/16/Python-2016-01-16-python-http/">2016-01-16</a></time>
        
  
    <h1 class="title">python-http</h1>
  

    </header>

    <div class="entry">
      
          <!--
       
              <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> post </strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Python-Spider-urllib-HTTP-urlib"><span class="toc-number">1.</span> <span class="toc-text">[Python][Spider][urllib]HTTP-urlib</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#POST和GET请求"><span class="toc-number">1.1.</span> <span class="toc-text">POST和GET请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#User-Agent"><span class="toc-number">1.2.</span> <span class="toc-text">User-Agent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie"><span class="toc-number">1.3.</span> <span class="toc-text">Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Proxy-代理-ProxyHandler"><span class="toc-number">1.4.</span> <span class="toc-text">Proxy 代理 ProxyHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模拟浏览器-POST-GET-方式"><span class="toc-number">1.5.</span> <span class="toc-text">模拟浏览器 POST GET 方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllib库"><span class="toc-number">1.6.</span> <span class="toc-text">urllib库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#urllib-request-urlopen"><span class="toc-number">1.6.1.</span> <span class="toc-text">urllib.request.urlopen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#urllib-request-Request"><span class="toc-number">1.6.2.</span> <span class="toc-text">urllib.request.Request</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#urllib-request-urlopen-Request-示例代码"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">urllib.request.(urlopen,Request)示例代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常见用法"><span class="toc-number">1.7.</span> <span class="toc-text">常见用法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#直接将URL保存为本地文件："><span class="toc-number">1.7.1.</span> <span class="toc-text">直接将URL保存为本地文件：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#打印HTTP-header"><span class="toc-number">1.7.2.</span> <span class="toc-text">打印HTTP header</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference-Link"><span class="toc-number">2.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

                  

                  -->
        <h2 id="Python-Spider-urllib-HTTP-urlib"><a href="#Python-Spider-urllib-HTTP-urlib" class="headerlink" title="[Python][Spider][urllib]HTTP-urlib"></a>[Python][Spider][urllib]HTTP-urlib</h2><p>@(3.09 - Python)[python, urllib, spider]</p>
<p>注:  </p>
<blockquote>
<p>  python 3.x中urllib库和urilib2库合并成了urllib库。<br>    其中urllib2.urlopen()变成了<code>urllib.request.urlopen()</code><br>    urllib2.Request()变成了<code>urllib.request.Request()</code></p>
</blockquote>
<pre><code>from urllib import request
</code></pre><h3 id="POST和GET请求"><a href="#POST和GET请求" class="headerlink" title="POST和GET请求"></a>POST和GET请求</h3><p>HTTP定义了与服务器交互的不同方法，最基本的方法有4种，分别是<strong>GET，POST，PUT，DELETE</strong>。</p>
<p>一个URL地址，它用于描述一个网络上的资源，而HTTP中的GET，POST，PUT，DELETE就对应着对这个资源的查，改，增，删4个操作。</p>
<p>其中，GET一般用于获取/查询资源信息，而POST一般用于更新资源信息，通常用于我们需要向服务器提交表单的情况。</p>
<p>比如说，我们在百度首页输入“宁哥的小站”，回车，然后地址栏会跳转到搜索结果的列表页。同时可以看到浏览器的地址栏会发生改变，类似于<code>http://www.baidu.com/s?wd=xxx</code>的形式。就是说，地址栏从百度首页<code>http://www.baidu.com/</code>跳转到了<code>http://www.baidu.com/s?wd=xxx</code><br>变化就在于，在最初的url后面会附加相关的字段，<strong>以？分割url和请求的数据</strong>，这些数据就是你要查询字段的编码。而这个过程，就是典型的GET请求的情况。</p>
<p>与之对应的POST请求则显得深藏不露，它在于你必须通过浏览器输入或提交一些服务器需要的数据，才能给你返回完整的界面，这点其实与GET请求情况有相通之处，但是<strong>这个过程浏览器的地址栏是不会发生跳转的</strong>。</p>
<p>POST请求提交的数据是如何传给服务器的呢？大家可以采用一些分析页面的手段来获取上传的数据。实际上，POST请求是将提交的数据放在HTTP包的包体中，这种方式无疑加强了数据的安全性，不像GET请求那样，用户可以通过跳转的url就可以查看出向服务器发送的数据。另外，POST请求除了提交数据外，还可以提交文件，这点也是GET请求做不到的。</p>
<h3 id="User-Agent"><a href="#User-Agent" class="headerlink" title="User-Agent"></a>User-Agent</h3><p>如何让网站们把我们的Python爬虫当成正规的浏览器来访. 因为如果不这么伪装自己, 有的网站就爬不回来了（有的网站专门拦截爬虫程序）. 如果看过理论方面的知识, 就知道我们是要在 GET 的时候将 User-Agent 添加到header里.</p>
<p>urllib提供的功能就是利用程序去执行各种HTTP请求。如果要模拟浏览器完成特定功能，需要把请求伪装成浏览器。伪装的方法是先监控浏览器发出的请求，再根据浏览器的请求头来伪装，User-Agent头就是用来标识浏览器的。</p>
<p><strong>Fiddler</strong></p>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p>有些网站需要登录后才能访问某个页面，在登录之前，你想抓取某个页面内容是不允许的。那么我们可以保存我们登录的Cookie，然后再抓取其他页面就达到目的了。</p>
<p>Cookie是HTTP消息头中的一种属性，包括：<br>Cookie名字（Name）Cookie的值（Value），Cookie的过期时间（Expires/Max-Age），Cookie作用路径（Path），Cookie所在域名（Domain），使用Cookie进行安全连接（Secure）。 前两个参数是Cookie应用的必要条件，另外，还包括Cookie大小（Size，不同浏览器对Cookie个数及大小限制是有差异的）。</p>
<p>有了Cookie，我们就可以实现自动登陆网站，甚至能够解决一些验证码登陆的情况。</p>
<p>在Python中，提供了cookielib这个模块，能够将cookie保存到本地，也可以保存在内存中。在第一次用用户名密码登陆网站之后，我们只需要如下创建opener对象，就可以记录cookie：</p>
<p>这样，接下来我们如果继续访问该域名的网站，直接采用<code>opener.open(需要输入的url)</code>，就能实现用保存的Cookie直接打开。</p>
<p>本来处理 Cookies 是个麻烦的事情, 不过 Python 的 http.cookiejar 库给了我们很方便的解决方案, 只要在创建 opener 的时候将一个 HTTPCookieProcessor 放进去, Cookies 的事情就不用我们管了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> http.cookiejar</div><div class="line"><span class="keyword">import</span> urllib.request</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getOpener</span><span class="params">(head)</span>:</span></div><div class="line">    <span class="comment"># deal with the Cookies</span></div><div class="line">    cj = http.cookiejar.CookieJar()</div><div class="line">    pro = urllib.request.HTTPCookieProcessor(cj)</div><div class="line">    opener = urllib.request.build_opener(pro)</div><div class="line">    header = []</div><div class="line">    <span class="keyword">for</span> key, value <span class="keyword">in</span> head.items():</div><div class="line">        elem = (key, value)</div><div class="line">        header.append(elem)</div><div class="line">    opener.addheaders = header</div><div class="line">    <span class="keyword">return</span> opener</div></pre></td></tr></table></figure>
<p>getOpener 函数接收一个 head 参数, 这个参数是一个字典. 函数把字典转换成元组集合, 放进 opener. 这样我们建立的这个 opener 就有两大功能:</p>
<ul>
<li>自动处理使用 opener 过程中遇到的 Cookies</li>
<li>自动在发出的 GET 或者 POST 请求中加上自定义的 Header</li>
</ul>
<h3 id="Proxy-代理-ProxyHandler"><a href="#Proxy-代理-ProxyHandler" class="headerlink" title="Proxy 代理 ProxyHandler"></a>Proxy 代理 ProxyHandler</h3><p>示例代码<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">proxy_handler = urllib.request.ProxyHandler(&#123;&apos;http&apos;: &apos;http://www.example.com:3128/&apos;&#125;)</div><div class="line">proxy_auth_handler = urllib.request.ProxyBasicAuthHandler()</div><div class="line">proxy_auth_handler.add_password(&apos;realm&apos;, &apos;host&apos;, &apos;username&apos;, &apos;password&apos;)</div><div class="line">opener = urllib.request.build_opener(proxy_handler, proxy_auth_handler)</div><div class="line">with opener.open(&apos;http://www.example.com/login.html&apos;) as f:</div><div class="line">    pass</div></pre></td></tr></table></figure></p>
<h3 id="模拟浏览器-POST-GET-方式"><a href="#模拟浏览器-POST-GET-方式" class="headerlink" title="模拟浏览器 POST GET 方式"></a>模拟浏览器 POST GET 方式</h3><p>POST方式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">import urllib.parse  </div><div class="line">import urllib.request  </div><div class="line"> </div><div class="line">url=&quot;http://liuxin-blog.appspot.com/messageboard/add&quot; </div><div class="line"></div><div class="line">values=&#123;&quot;content&quot;:&quot;命令行发出网页请求测试&quot;&#125;  </div><div class="line">data=urllib.parse.urlencode(values) </div><div class="line"></div><div class="line"># 创建请求对象  </div><div class="line">req=urllib.request.Request(url,data) </div><div class="line">#获得服务器返回的数据  </div><div class="line">response=urllib.request.urlopen(req) </div><div class="line">#处理数据  </div><div class="line">page=response.read()</div></pre></td></tr></table></figure>
<p>GET方式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">import urllib.parse  </div><div class="line">import urllib.request  </div><div class="line"></div><div class="line">url=&quot;http://www.google.cn/webhp&quot; </div><div class="line"></div><div class="line">values=&#123;&quot;rls&quot;:&quot;ig&quot;&#125;  </div><div class="line">data=urllib.parse.urlencode(values)  </div><div class="line"></div><div class="line">theurl=url+&quot;?&quot;+data </div><div class="line">#创建请求对象  </div><div class="line">req=urllib.request.Request(theurl) </div><div class="line">#获得服务器返回的数据  </div><div class="line">response=urllib.request.urlopen(req) </div><div class="line">#处理数据  </div><div class="line">page=response.read()</div></pre></td></tr></table></figure>
<h3 id="urllib库"><a href="#urllib库" class="headerlink" title="urllib库"></a>urllib库</h3><p>urllib.request module uses <strong>HTTP/1.1</strong> and includes <code>Connection:close</code> header in its HTTP requests.</p>
<p>对于Response对象</p>
<ul>
<li>geturl() — return the URL of the resource retrieved, commonly used to determine if a redirect was followed</li>
<li>info() — return the meta-information of the page, such as headers, in the form of an email.message_from_string() instance (see Quick Reference to HTTP Headers)</li>
<li>getcode() – return the HTTP status code of the response.</li>
</ul>
<p>geturl()的设置是为了辨别是否有服务器端的网址重定向,而info()[getheaders()]则包含了一系列的信息。</p>
<ol>
<li>info()</li>
<li>gerheaders()</li>
<li>f.status</li>
<li>f.reason</li>
</ol>
<h4 id="urllib-request-urlopen"><a href="#urllib-request-urlopen" class="headerlink" title="urllib.request.urlopen"></a>urllib.request.urlopen</h4><p>使用urllib.request库中的<code>urlopen(url)</code>函数来打开网页，函数参数url只能接受utf-8编码方式(因为Python脚本文件用utf-8编码)</p>
<p>urlopen一般接受三个参数，它的参数如下：<code>urlopen(url, data, timeout)</code></p>
<blockquote>
<p>第二三个参数是可以不传送的，data默认为空 None，timeout默认为 <code>socket._GLOBAL_DEFAULT_TIMEOUT</code></p>
<p>第一个参数URL是必须要传送的，url参数可以是一个字符串或者是一个Request请求。The URL url, which can be either a string or a Request object.<br>执行urlopen方法之后，返回一个<strong>response对象</strong>，返回信息便保存在这里面。</p>
<p>the HTTP request will be a <strong>POST</strong> instead of a <strong>GET</strong> when the data parameter is provided.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</div><div class="line">url = <span class="string">"https://api.douban.com/v2/book/2129650"</span></div><div class="line">Urequest = request.Request(url)</div><div class="line"><span class="keyword">with</span> request.urlopen(Urequest, timeout=<span class="number">5</span>) <span class="keyword">as</span> f:</div><div class="line">    print(f.read().decode(<span class="string">'utf-8'</span>))</div></pre></td></tr></table></figure>
<h4 id="urllib-request-Request"><a href="#urllib-request-Request" class="headerlink" title="urllib.request.Request"></a>urllib.request.Request</h4><p><code>urllib.request.Request((url, data=None, headers={}, origin_req_host=None, unverifiable=False, method=None))</code></p>
<ul>
<li><p><code>urllib.parse.urlencode()</code><br>data should be a buffer in the standard application/x-www-form-urlencoded format. The urllib.parse.urlencode() function takes a mapping or sequence of 2-tuples and returns an ASCII string in this format. <strong>It should be encoded to bytes before being used as the data parameter.</strong><br>如果要以POST发送一个请求，只需要把参数data以bytes形式传入。POST的表单数据用<code>urllib.parse.urlencode()</code>来格式化，该函数接收2-tuple数据，返回ASCII的字符串<br>POST data should be bytes or an iterable of bytes. It cannot be of type str。urlencode()返回的是ASCII的字符串，所以在引用的时候应该encode成Bytes类型的。</p>
</li>
<li><p><code>add_header()</code><br>给HTTP POST/GET添加请求报头，常用来伪装成浏览器<br><em>For example, Mozilla Firefox may identify itself as “Mozilla/5.0 (X11; U; Linux i686) Gecko/20071127 Firefox/2.0.0.11”, while urllib‘s default user agent string is “Python-urllib/2.6” (on Python 2.6).</em></p>
</li>
</ul>
<h5 id="urllib-request-urlopen-Request-示例代码"><a href="#urllib-request-urlopen-Request-示例代码" class="headerlink" title="urllib.request.(urlopen,Request)示例代码"></a>urllib.request.(urlopen,Request)示例代码</h5><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request, parse</div><div class="line"></div><div class="line">print(<span class="string">'Login to weibo.cn...'</span>)</div><div class="line">email = input(<span class="string">'Email: '</span>)</div><div class="line">passwd = input(<span class="string">'Password: '</span>)</div><div class="line">login_data = parse.urlencode([</div><div class="line">    (<span class="string">'username'</span>, email),</div><div class="line">    (<span class="string">'password'</span>, passwd),</div><div class="line">    (<span class="string">'entry'</span>, <span class="string">'mweibo'</span>),</div><div class="line">    (<span class="string">'client_id'</span>, <span class="string">''</span>),</div><div class="line">    (<span class="string">'savestate'</span>, <span class="string">'1'</span>),</div><div class="line">    (<span class="string">'ec'</span>, <span class="string">''</span>),</div><div class="line">    (<span class="string">'pagerefer'</span>, <span class="string">'https://passport.weibo.cn/signin/welcome?entry=mweibo&amp;r=http%3A%2F%2Fm.weibo.cn%2F'</span>)</div><div class="line">])</div><div class="line"></div><div class="line">req = request.Request(<span class="string">'https://passport.weibo.cn/sso/login'</span>)</div><div class="line">req.add_header(<span class="string">'Origin'</span>, <span class="string">'https://passport.weibo.cn'</span>)</div><div class="line">req.add_header(<span class="string">'User-Agent'</span>, <span class="string">'Mozilla/6.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/8.0 Mobile/10A5376e Safari/8536.25'</span>)</div><div class="line">req.add_header(<span class="string">'Referer'</span>, <span class="string">'https://passport.weibo.cn/signin/login?entry=mweibo&amp;res=wel&amp;wm=3349&amp;r=http%3A%2F%2Fm.weibo.cn%2F'</span>)</div><div class="line"></div><div class="line"><span class="keyword">with</span> request.urlopen(req, data=login_data.encode(<span class="string">'utf-8'</span>)) <span class="keyword">as</span> f:</div><div class="line">    print(<span class="string">'Status:'</span>, f.status, f.reason)</div><div class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> f.getheaders():</div><div class="line">        print(<span class="string">'%s: %s'</span> % (k, v))</div><div class="line">    print(<span class="string">'Data:'</span>, f.read().decode(<span class="string">'utf-8'</span>))</div></pre></td></tr></table></figure>
<h3 id="常见用法"><a href="#常见用法" class="headerlink" title="常见用法"></a>常见用法</h3><h4 id="直接将URL保存为本地文件："><a href="#直接将URL保存为本地文件：" class="headerlink" title="直接将URL保存为本地文件："></a>直接将URL保存为本地文件：</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">import urllib.request</div><div class="line">url=&quot;http://www.xxxx.com/1.jpg&quot;</div><div class="line">urllib.request.urlretrieve(url,r&quot;d:\temp\1.jpg&quot;)</div></pre></td></tr></table></figure>
<h4 id="打印HTTP-header"><a href="#打印HTTP-header" class="headerlink" title="打印HTTP header"></a>打印HTTP header</h4><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</div><div class="line">url = <span class="string">"https://api.douban.com/v2/book/2129650"</span></div><div class="line">Urequest = request.Request(url)</div><div class="line"><span class="keyword">with</span> request.urlopen(Urequest, timeout=<span class="number">5</span>) <span class="keyword">as</span> f:</div><div class="line">    data = f.read()</div><div class="line">    <span class="keyword">print</span> (<span class="string">'Status:'</span>, f.status, f.reason)</div><div class="line">    <span class="comment"># print(f.read().decode('utf-8'))</span></div><div class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> f.getheaders() :</div><div class="line">        <span class="keyword">print</span> (<span class="string">"%s : %s"</span> % (k, v))</div><div class="line">    &gt; print(<span class="string">"Data: "</span>, data.decode(<span class="string">'utf-8'</span>))</div></pre></td></tr></table></figure>
<h2 id="Reference-Link"><a href="#Reference-Link" class="headerlink" title="Reference Link"></a>Reference Link</h2><ol>
<li><a href="https://docs.python.org/3.4/library/urllib.request.html?highlight=request#module-urllib.request" target="_blank" rel="external">iurllib.request — Extensible library for opening URLs</a></li>
<li><a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001432688314740a0aed473a39f47b09c8c7274c9ab6aee000" target="_blank" rel="external">urllib-廖雪峰</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
  
  <div class="tags">
    <a href="/hexo_blog/tags/python/">python</a>
  </div>

        <div class = "counter">
  <span id="busuanzi_container_page_pv" style="display:none">
      总访问&nbsp<span id="busuanzi_value_page_pv"></span>&nbsp次
  </span>
</div>
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>

  <section id = "relate">
    
		
</section>


  
    <section id="comment">
    <!--   <h1 class="title">留言</h1> -->
    
    
    </section>




</div></div>
        <aside id="sidebar" class="alignright">
    <div class="closeaside"><a class="closebutton" href="#" title="显示分类"> </a></div>
  

   <div class="search">
  <form action="//baidu.com/s" method="get" accept-charset="utf-8">
    <input type="search" name="wd"results="0" placeholder="搜索">
    <input type="hidden" name="wd" value="site:ywlbupt.github.com/hexo_blog">
  </form>
</div> 


  
<div class="widget tag">
  <h3 class="title" id="categories">分类</h3>
<!--   
	
		<li><a class = "list-2"href="/hexo_blog/categories/Python/Basic/">Basic</a><small>1</small></li>
     
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Ubuntu/Cmd/">Cmd</a><small>2</small></li>
     
  
	
		<li><a href="/hexo_blog/categories/Diary/">Diary</a><small>0</small></li>
	
  
	
		<li><a href="/hexo_blog/categories/Gallery/">Gallery</a><small>0</small></li>
	
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Markdown/Hexo/">Hexo</a><small>3</small></li>
     
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Ubuntu/IDE-Config/">IDE_Config</a><small>1</small></li>
     
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Python/Lib/">Lib</a><small>3</small></li>
     
  
	
		<li><a href="/hexo_blog/categories/Markdown/">Markdown</a><small>3</small></li>
	
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Vim/Plugin/">Plugin</a><small>2</small></li>
     
  
	
		<li><a href="/hexo_blog/categories/Python/">Python</a><small>7</small></li>
	
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Python/Python-Basic/">Python_Basic</a><small>3</small></li>
     
  
	
		<li><a href="/hexo_blog/categories/Ubuntu/">Ubuntu</a><small>3</small></li>
	
  
	
		<li><a href="/hexo_blog/categories/Vim/">Vim</a><small>3</small></li>
	
   -->


     <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Markdown/">Markdown</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Markdown/Hexo/">Hexo</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Python/">Python</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Python/Basic/">Basic</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Python/Lib/">Lib</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Python/Python-Basic/">Python_Basic</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Ubuntu/">Ubuntu</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Ubuntu/Cmd/">Cmd</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Ubuntu/IDE-Config/">IDE_Config</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Vim/">Vim</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Vim/Plugin/">Plugin</a><span class="category-list-count">2</span></li></ul></li></ul> 
</div>
 


  <div class="widget tag">
  <h3 class="title">日历云</h3>
  <div id="calendar"></div>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/hexo_blog/tags/deb/" style="font-size: 10px;">deb</a> <a href="/hexo_blog/tags/ejs引擎/" style="font-size: 10px;">ejs引擎</a> <a href="/hexo_blog/tags/find/" style="font-size: 10px;">find</a> <a href="/hexo_blog/tags/git/" style="font-size: 16.67px;">git</a> <a href="/hexo_blog/tags/grep/" style="font-size: 10px;">grep</a> <a href="/hexo_blog/tags/hexo/" style="font-size: 13.33px;">hexo</a> <a href="/hexo_blog/tags/jacman/" style="font-size: 13.33px;">jacman</a> <a href="/hexo_blog/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/hexo_blog/tags/json/" style="font-size: 10px;">json</a> <a href="/hexo_blog/tags/os/" style="font-size: 10px;">os</a> <a href="/hexo_blog/tags/python/" style="font-size: 20px;">python</a> <a href="/hexo_blog/tags/snippets/" style="font-size: 10px;">snippets</a> <a href="/hexo_blog/tags/tutorial/" style="font-size: 10px;">tutorial</a> <a href="/hexo_blog/tags/vim/" style="font-size: 13.33px;">vim</a> <a href="/hexo_blog/tags/yaml/" style="font-size: 10px;">yaml</a> <a href="/hexo_blog/tags/zt/" style="font-size: 10px;">zt</a>
  </div>
</div>


</aside>

      <div class="clearfix"></div>
    </div>
  
  <footer id="footer"><div class="footer-content inner">
  <div class="alignleft">
  
    &copy; 2016 Wlin
    
  </div>
  <div class="alignright">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme
    <a href="https://github.com/pengloo53/Hexo-theme-light_cn">light_cn</a>
  </div>
  
  <div class="visit">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
  </div>
  
  <div class="clearfix"></div>
</div></footer>
  <script src="http://libs.baidu.com/jquery/2.1.1/jquery.min.js"></script>
<script src="/hexo_blog/js/jquery.imagesloaded.min.js"></script>
<script src="/hexo_blog/js/gallery.js"></script>

<!-- add calendar widget -->

  <script src="/hexo_blog/js/calendar.js"></script>
  <script src="/hexo_blog/js/languages.js"></script>
  <script type="text/javascript">
    $(function() {
    
      $('#calendar').aCalendar('zh-CN',{single:undefined, root:'calendar'});
    
    });
  </script>


<!-- 添加『不蒜子』计数服务 -->
<script async src="http://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<div id="toTop">
	<a href="#">▲</a>
	<a href="#footer">▼</a>
</div>


<!-- 目录与分类的切换按钮 -->
<script type="text/javascript">
$(document).ready(function(){ 
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#sidebar'),
      c = $('.closeaside'),
      o = $('.openaside');
      t = $('#toc.toc-aside')
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    // t.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    t.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  // $(window).scroll(function(){
    // ta.css("top",Math.max(140,320-$(this).scrollTop()));
  // });
});
</script>


</body>
</html>


