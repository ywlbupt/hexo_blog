<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 3 页 | WiZero</title>
  <meta name="author" content="Wlin">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="WiZero"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  <link rel="alternate" href="/hexo_blog/atom.xml" title="WiZero" type="application/atom+xml">
  <link rel="stylesheet" href="/hexo_blog/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <meta name="wumiiVerification" content="fb50a101-84fe-4ca2-91a7-ae8cf792978b" />
  
  <meta name="wumiiVerification" content="d73b5866-c390-4156-a4dd-51b526b5335e" />
</head>

<body>
  <header id="header">
<div class= "header-content inner">
	<div class = "alignleft col-one">
		
			<div class='avatar'>
				<img src = "/hexo_blog/images/site/lufy-avatar.jpg">
              </div>
		
		<div class="header-div">
		    <h1><a href="/hexo_blog/">WiZero</a></h1>
		    <h2><a href="/hexo_blog/">阅读，思考，实践，不忘初心</a></h2>
		</div>
	</div>
	<div class = "alignright col-two">
		
	</div>
	<div class="clearfix"></div>
</div>

<div class= "header-nav">
	<div class='header-nav-content inner'>
		<div id="main-nav" class="alignleft">
			<ul>
		    		
		    		  <li><a href="/hexo_blog/./">首页</a></li>
		    		
		    		  <li><a href="/hexo_blog/archives">归档</a></li>
		    		
		    	</ul>
		</div>
		<div id="sub-nav" class="alignright">
     	 <ul>
		    
		      <li><a href="/hexo_blog/atom.xml">订阅</a></li>
		    
		      <li><a href="/hexo_blog/customization">留言</a></li>
		    
     	 </ul>
		</div>
	</div>
	<div class="clearfix"></div>
</div>
</header>
  
    <div id="content" class="inner">
      <div id="main-col" class="alignleft"><div id="wrapper">
	
    		
    
      <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Python-Spider-urllib-HTTP-urlib"><span class="toc-number">1.</span> <span class="toc-text">[Python][Spider][urllib]HTTP-urlib</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#POST和GET请求"><span class="toc-number">1.1.</span> <span class="toc-text">POST和GET请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#User-Agent"><span class="toc-number">1.2.</span> <span class="toc-text">User-Agent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie"><span class="toc-number">1.3.</span> <span class="toc-text">Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Proxy-代理-ProxyHandler"><span class="toc-number">1.4.</span> <span class="toc-text">Proxy 代理 ProxyHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模拟浏览器-POST-GET-方式"><span class="toc-number">1.5.</span> <span class="toc-text">模拟浏览器 POST GET 方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllib库"><span class="toc-number">1.6.</span> <span class="toc-text">urllib库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#urllib-request-urlopen"><span class="toc-number">1.6.1.</span> <span class="toc-text">urllib.request.urlopen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#urllib-request-Request"><span class="toc-number">1.6.2.</span> <span class="toc-text">urllib.request.Request</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#urllib-request-urlopen-Request-示例代码"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">urllib.request.(urlopen,Request)示例代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常见用法"><span class="toc-number">1.7.</span> <span class="toc-text">常见用法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#直接将URL保存为本地文件："><span class="toc-number">1.7.1.</span> <span class="toc-text">直接将URL保存为本地文件：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#打印HTTP-header"><span class="toc-number">1.7.2.</span> <span class="toc-text">打印HTTP header</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference-Link"><span class="toc-number">2.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

      
  

      
<article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2016-01-16T08:18:05.000Z"><a href="/hexo_blog/2016/01/16/Python-2016-01-16-python-http/">2016-01-16</a></time>
        
  
    <h1 class="title"><a href="/hexo_blog/2016/01/16/Python-2016-01-16-python-http/">python-http</a></h1>
  

    </header>

    <div class="entry">
      
          <!--
       
              <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Python-Spider-urllib-HTTP-urlib"><span class="toc-number">1.</span> <span class="toc-text">[Python][Spider][urllib]HTTP-urlib</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#POST和GET请求"><span class="toc-number">1.1.</span> <span class="toc-text">POST和GET请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#User-Agent"><span class="toc-number">1.2.</span> <span class="toc-text">User-Agent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie"><span class="toc-number">1.3.</span> <span class="toc-text">Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Proxy-代理-ProxyHandler"><span class="toc-number">1.4.</span> <span class="toc-text">Proxy 代理 ProxyHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模拟浏览器-POST-GET-方式"><span class="toc-number">1.5.</span> <span class="toc-text">模拟浏览器 POST GET 方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllib库"><span class="toc-number">1.6.</span> <span class="toc-text">urllib库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#urllib-request-urlopen"><span class="toc-number">1.6.1.</span> <span class="toc-text">urllib.request.urlopen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#urllib-request-Request"><span class="toc-number">1.6.2.</span> <span class="toc-text">urllib.request.Request</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#urllib-request-urlopen-Request-示例代码"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">urllib.request.(urlopen,Request)示例代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常见用法"><span class="toc-number">1.7.</span> <span class="toc-text">常见用法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#直接将URL保存为本地文件："><span class="toc-number">1.7.1.</span> <span class="toc-text">直接将URL保存为本地文件：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#打印HTTP-header"><span class="toc-number">1.7.2.</span> <span class="toc-text">打印HTTP header</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference-Link"><span class="toc-number">2.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

                  

                  -->
        <h2 id="Python-Spider-urllib-HTTP-urlib"><a href="#Python-Spider-urllib-HTTP-urlib" class="headerlink" title="[Python][Spider][urllib]HTTP-urlib"></a>[Python][Spider][urllib]HTTP-urlib</h2><p>@(3.09 - Python)[python, urllib, spider]</p>
<p>注:  </p>
<blockquote>
<p>  python 3.x中urllib库和urilib2库合并成了urllib库。<br>    其中urllib2.urlopen()变成了<code>urllib.request.urlopen()</code><br>    urllib2.Request()变成了<code>urllib.request.Request()</code></p>
</blockquote>
<pre><code>from urllib import request
</code></pre><h3 id="POST和GET请求"><a href="#POST和GET请求" class="headerlink" title="POST和GET请求"></a>POST和GET请求</h3><p>HTTP定义了与服务器交互的不同方法，最基本的方法有4种，分别是<strong>GET，POST，PUT，DELETE</strong>。</p>
<p>一个URL地址，它用于描述一个网络上的资源，而HTTP中的GET，POST，PUT，DELETE就对应着对这个资源的查，改，增，删4个操作。</p>
<p>其中，GET一般用于获取/查询资源信息，而POST一般用于更新资源信息，通常用于我们需要向服务器提交表单的情况。</p>
<p>比如说，我们在百度首页输入“宁哥的小站”，回车，然后地址栏会跳转到搜索结果的列表页。同时可以看到浏览器的地址栏会发生改变，类似于<code>http://www.baidu.com/s?wd=xxx</code>的形式。就是说，地址栏从百度首页<code>http://www.baidu.com/</code>跳转到了<code>http://www.baidu.com/s?wd=xxx</code><br>变化就在于，在最初的url后面会附加相关的字段，<strong>以？分割url和请求的数据</strong>，这些数据就是你要查询字段的编码。而这个过程，就是典型的GET请求的情况。</p>
<p>与之对应的POST请求则显得深藏不露，它在于你必须通过浏览器输入或提交一些服务器需要的数据，才能给你返回完整的界面，这点其实与GET请求情况有相通之处，但是<strong>这个过程浏览器的地址栏是不会发生跳转的</strong>。</p>
<p>POST请求提交的数据是如何传给服务器的呢？大家可以采用一些分析页面的手段来获取上传的数据。实际上，POST请求是将提交的数据放在HTTP包的包体中，这种方式无疑加强了数据的安全性，不像GET请求那样，用户可以通过跳转的url就可以查看出向服务器发送的数据。另外，POST请求除了提交数据外，还可以提交文件，这点也是GET请求做不到的。</p>
<h3 id="User-Agent"><a href="#User-Agent" class="headerlink" title="User-Agent"></a>User-Agent</h3><p>如何让网站们把我们的Python爬虫当成正规的浏览器来访. 因为如果不这么伪装自己, 有的网站就爬不回来了（有的网站专门拦截爬虫程序）. 如果看过理论方面的知识, 就知道我们是要在 GET 的时候将 User-Agent 添加到header里.</p>
<p>urllib提供的功能就是利用程序去执行各种HTTP请求。如果要模拟浏览器完成特定功能，需要把请求伪装成浏览器。伪装的方法是先监控浏览器发出的请求，再根据浏览器的请求头来伪装，User-Agent头就是用来标识浏览器的。</p>
<p><strong>Fiddler</strong></p>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p>有些网站需要登录后才能访问某个页面，在登录之前，你想抓取某个页面内容是不允许的。那么我们可以保存我们登录的Cookie，然后再抓取其他页面就达到目的了。</p>
<p>Cookie是HTTP消息头中的一种属性，包括：<br>Cookie名字（Name）Cookie的值（Value），Cookie的过期时间（Expires/Max-Age），Cookie作用路径（Path），Cookie所在域名（Domain），使用Cookie进行安全连接（Secure）。 前两个参数是Cookie应用的必要条件，另外，还包括Cookie大小（Size，不同浏览器对Cookie个数及大小限制是有差异的）。</p>
<p>有了Cookie，我们就可以实现自动登陆网站，甚至能够解决一些验证码登陆的情况。</p>
<p>在Python中，提供了cookielib这个模块，能够将cookie保存到本地，也可以保存在内存中。在第一次用用户名密码登陆网站之后，我们只需要如下创建opener对象，就可以记录cookie：</p>
<p>这样，接下来我们如果继续访问该域名的网站，直接采用<code>opener.open(需要输入的url)</code>，就能实现用保存的Cookie直接打开。</p>
<p>本来处理 Cookies 是个麻烦的事情, 不过 Python 的 http.cookiejar 库给了我们很方便的解决方案, 只要在创建 opener 的时候将一个 HTTPCookieProcessor 放进去, Cookies 的事情就不用我们管了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> http.cookiejar</div><div class="line"><span class="keyword">import</span> urllib.request</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getOpener</span><span class="params">(head)</span>:</span></div><div class="line">    <span class="comment"># deal with the Cookies</span></div><div class="line">    cj = http.cookiejar.CookieJar()</div><div class="line">    pro = urllib.request.HTTPCookieProcessor(cj)</div><div class="line">    opener = urllib.request.build_opener(pro)</div><div class="line">    header = []</div><div class="line">    <span class="keyword">for</span> key, value <span class="keyword">in</span> head.items():</div><div class="line">        elem = (key, value)</div><div class="line">        header.append(elem)</div><div class="line">    opener.addheaders = header</div><div class="line">    <span class="keyword">return</span> opener</div></pre></td></tr></table></figure>
<p>getOpener 函数接收一个 head 参数, 这个参数是一个字典. 函数把字典转换成元组集合, 放进 opener. 这样我们建立的这个 opener 就有两大功能:</p>
<ul>
<li>自动处理使用 opener 过程中遇到的 Cookies</li>
<li>自动在发出的 GET 或者 POST 请求中加上自定义的 Header</li>
</ul>
<h3 id="Proxy-代理-ProxyHandler"><a href="#Proxy-代理-ProxyHandler" class="headerlink" title="Proxy 代理 ProxyHandler"></a>Proxy 代理 ProxyHandler</h3><p>示例代码<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">proxy_handler = urllib.request.ProxyHandler(&#123;&apos;http&apos;: &apos;http://www.example.com:3128/&apos;&#125;)</div><div class="line">proxy_auth_handler = urllib.request.ProxyBasicAuthHandler()</div><div class="line">proxy_auth_handler.add_password(&apos;realm&apos;, &apos;host&apos;, &apos;username&apos;, &apos;password&apos;)</div><div class="line">opener = urllib.request.build_opener(proxy_handler, proxy_auth_handler)</div><div class="line">with opener.open(&apos;http://www.example.com/login.html&apos;) as f:</div><div class="line">    pass</div></pre></td></tr></table></figure></p>
<h3 id="模拟浏览器-POST-GET-方式"><a href="#模拟浏览器-POST-GET-方式" class="headerlink" title="模拟浏览器 POST GET 方式"></a>模拟浏览器 POST GET 方式</h3><p>POST方式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">import urllib.parse  </div><div class="line">import urllib.request  </div><div class="line"> </div><div class="line">url=&quot;http://liuxin-blog.appspot.com/messageboard/add&quot; </div><div class="line"></div><div class="line">values=&#123;&quot;content&quot;:&quot;命令行发出网页请求测试&quot;&#125;  </div><div class="line">data=urllib.parse.urlencode(values) </div><div class="line"></div><div class="line"># 创建请求对象  </div><div class="line">req=urllib.request.Request(url,data) </div><div class="line">#获得服务器返回的数据  </div><div class="line">response=urllib.request.urlopen(req) </div><div class="line">#处理数据  </div><div class="line">page=response.read()</div></pre></td></tr></table></figure>
<p>GET方式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">import urllib.parse  </div><div class="line">import urllib.request  </div><div class="line"></div><div class="line">url=&quot;http://www.google.cn/webhp&quot; </div><div class="line"></div><div class="line">values=&#123;&quot;rls&quot;:&quot;ig&quot;&#125;  </div><div class="line">data=urllib.parse.urlencode(values)  </div><div class="line"></div><div class="line">theurl=url+&quot;?&quot;+data </div><div class="line">#创建请求对象  </div><div class="line">req=urllib.request.Request(theurl) </div><div class="line">#获得服务器返回的数据  </div><div class="line">response=urllib.request.urlopen(req) </div><div class="line">#处理数据  </div><div class="line">page=response.read()</div></pre></td></tr></table></figure>
<h3 id="urllib库"><a href="#urllib库" class="headerlink" title="urllib库"></a>urllib库</h3><p>urllib.request module uses <strong>HTTP/1.1</strong> and includes <code>Connection:close</code> header in its HTTP requests.</p>
<p>对于Response对象</p>
<ul>
<li>geturl() — return the URL of the resource retrieved, commonly used to determine if a redirect was followed</li>
<li>info() — return the meta-information of the page, such as headers, in the form of an email.message_from_string() instance (see Quick Reference to HTTP Headers)</li>
<li>getcode() – return the HTTP status code of the response.</li>
</ul>
<p>geturl()的设置是为了辨别是否有服务器端的网址重定向,而info()[getheaders()]则包含了一系列的信息。</p>
<ol>
<li>info()</li>
<li>gerheaders()</li>
<li>f.status</li>
<li>f.reason</li>
</ol>
<h4 id="urllib-request-urlopen"><a href="#urllib-request-urlopen" class="headerlink" title="urllib.request.urlopen"></a>urllib.request.urlopen</h4><p>使用urllib.request库中的<code>urlopen(url)</code>函数来打开网页，函数参数url只能接受utf-8编码方式(因为Python脚本文件用utf-8编码)</p>
<p>urlopen一般接受三个参数，它的参数如下：<code>urlopen(url, data, timeout)</code></p>
<blockquote>
<p>第二三个参数是可以不传送的，data默认为空 None，timeout默认为 <code>socket._GLOBAL_DEFAULT_TIMEOUT</code></p>
<p>第一个参数URL是必须要传送的，url参数可以是一个字符串或者是一个Request请求。The URL url, which can be either a string or a Request object.<br>执行urlopen方法之后，返回一个<strong>response对象</strong>，返回信息便保存在这里面。</p>
<p>the HTTP request will be a <strong>POST</strong> instead of a <strong>GET</strong> when the data parameter is provided.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</div><div class="line">url = <span class="string">"https://api.douban.com/v2/book/2129650"</span></div><div class="line">Urequest = request.Request(url)</div><div class="line"><span class="keyword">with</span> request.urlopen(Urequest, timeout=<span class="number">5</span>) <span class="keyword">as</span> f:</div><div class="line">    print(f.read().decode(<span class="string">'utf-8'</span>))</div></pre></td></tr></table></figure>
<h4 id="urllib-request-Request"><a href="#urllib-request-Request" class="headerlink" title="urllib.request.Request"></a>urllib.request.Request</h4><p><code>urllib.request.Request((url, data=None, headers={}, origin_req_host=None, unverifiable=False, method=None))</code></p>
<ul>
<li><p><code>urllib.parse.urlencode()</code><br>data should be a buffer in the standard application/x-www-form-urlencoded format. The urllib.parse.urlencode() function takes a mapping or sequence of 2-tuples and returns an ASCII string in this format. <strong>It should be encoded to bytes before being used as the data parameter.</strong><br>如果要以POST发送一个请求，只需要把参数data以bytes形式传入。POST的表单数据用<code>urllib.parse.urlencode()</code>来格式化，该函数接收2-tuple数据，返回ASCII的字符串<br>POST data should be bytes or an iterable of bytes. It cannot be of type str。urlencode()返回的是ASCII的字符串，所以在引用的时候应该encode成Bytes类型的。</p>
</li>
<li><p><code>add_header()</code><br>给HTTP POST/GET添加请求报头，常用来伪装成浏览器<br><em>For example, Mozilla Firefox may identify itself as “Mozilla/5.0 (X11; U; Linux i686) Gecko/20071127 Firefox/2.0.0.11”, while urllib‘s default user agent string is “Python-urllib/2.6” (on Python 2.6).</em></p>
</li>
</ul>
<h5 id="urllib-request-urlopen-Request-示例代码"><a href="#urllib-request-urlopen-Request-示例代码" class="headerlink" title="urllib.request.(urlopen,Request)示例代码"></a>urllib.request.(urlopen,Request)示例代码</h5><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request, parse</div><div class="line"></div><div class="line">print(<span class="string">'Login to weibo.cn...'</span>)</div><div class="line">email = input(<span class="string">'Email: '</span>)</div><div class="line">passwd = input(<span class="string">'Password: '</span>)</div><div class="line">login_data = parse.urlencode([</div><div class="line">    (<span class="string">'username'</span>, email),</div><div class="line">    (<span class="string">'password'</span>, passwd),</div><div class="line">    (<span class="string">'entry'</span>, <span class="string">'mweibo'</span>),</div><div class="line">    (<span class="string">'client_id'</span>, <span class="string">''</span>),</div><div class="line">    (<span class="string">'savestate'</span>, <span class="string">'1'</span>),</div><div class="line">    (<span class="string">'ec'</span>, <span class="string">''</span>),</div><div class="line">    (<span class="string">'pagerefer'</span>, <span class="string">'https://passport.weibo.cn/signin/welcome?entry=mweibo&amp;r=http%3A%2F%2Fm.weibo.cn%2F'</span>)</div><div class="line">])</div><div class="line"></div><div class="line">req = request.Request(<span class="string">'https://passport.weibo.cn/sso/login'</span>)</div><div class="line">req.add_header(<span class="string">'Origin'</span>, <span class="string">'https://passport.weibo.cn'</span>)</div><div class="line">req.add_header(<span class="string">'User-Agent'</span>, <span class="string">'Mozilla/6.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/8.0 Mobile/10A5376e Safari/8536.25'</span>)</div><div class="line">req.add_header(<span class="string">'Referer'</span>, <span class="string">'https://passport.weibo.cn/signin/login?entry=mweibo&amp;res=wel&amp;wm=3349&amp;r=http%3A%2F%2Fm.weibo.cn%2F'</span>)</div><div class="line"></div><div class="line"><span class="keyword">with</span> request.urlopen(req, data=login_data.encode(<span class="string">'utf-8'</span>)) <span class="keyword">as</span> f:</div><div class="line">    print(<span class="string">'Status:'</span>, f.status, f.reason)</div><div class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> f.getheaders():</div><div class="line">        print(<span class="string">'%s: %s'</span> % (k, v))</div><div class="line">    print(<span class="string">'Data:'</span>, f.read().decode(<span class="string">'utf-8'</span>))</div></pre></td></tr></table></figure>
<h3 id="常见用法"><a href="#常见用法" class="headerlink" title="常见用法"></a>常见用法</h3><h4 id="直接将URL保存为本地文件："><a href="#直接将URL保存为本地文件：" class="headerlink" title="直接将URL保存为本地文件："></a>直接将URL保存为本地文件：</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">import urllib.request</div><div class="line">url=&quot;http://www.xxxx.com/1.jpg&quot;</div><div class="line">urllib.request.urlretrieve(url,r&quot;d:\temp\1.jpg&quot;)</div></pre></td></tr></table></figure>
<h4 id="打印HTTP-header"><a href="#打印HTTP-header" class="headerlink" title="打印HTTP header"></a>打印HTTP header</h4><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</div><div class="line">url = <span class="string">"https://api.douban.com/v2/book/2129650"</span></div><div class="line">Urequest = request.Request(url)</div><div class="line"><span class="keyword">with</span> request.urlopen(Urequest, timeout=<span class="number">5</span>) <span class="keyword">as</span> f:</div><div class="line">    data = f.read()</div><div class="line">    <span class="keyword">print</span> (<span class="string">'Status:'</span>, f.status, f.reason)</div><div class="line">    <span class="comment"># print(f.read().decode('utf-8'))</span></div><div class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> f.getheaders() :</div><div class="line">        <span class="keyword">print</span> (<span class="string">"%s : %s"</span> % (k, v))</div><div class="line">    &gt; print(<span class="string">"Data: "</span>, data.decode(<span class="string">'utf-8'</span>))</div></pre></td></tr></table></figure>
<h2 id="Reference-Link"><a href="#Reference-Link" class="headerlink" title="Reference Link"></a>Reference Link</h2><ol>
<li><a href="https://docs.python.org/3.4/library/urllib.request.html?highlight=request#module-urllib.request" target="_blank" rel="external">iurllib.request — Extensible library for opening URLs</a></li>
<li><a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001432688314740a0aed473a39f47b09c8c7274c9ab6aee000" target="_blank" rel="external">urllib-廖雪峰</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



    	

	
    		
    
      <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本介绍-python3的字符串编码"><span class="toc-number">1.</span> <span class="toc-text">基本介绍-python3的字符串编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#python3-中字符串编码的转换"><span class="toc-number">1.1.</span> <span class="toc-text">python3 中字符串编码的转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#python2-x-中的字符串编码转换"><span class="toc-number">1.2.</span> <span class="toc-text">python2.x 中的字符串编码转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#isinstance-判断"><span class="toc-number">1.3.</span> <span class="toc-text">isinstance 判断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#获取系统默认编码"><span class="toc-number">1.4.</span> <span class="toc-text">获取系统默认编码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#单字节的处理"><span class="toc-number">1.5.</span> <span class="toc-text">单字节的处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#codecs-模块简介"><span class="toc-number">2.</span> <span class="toc-text">codecs 模块简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#python2-读写文件"><span class="toc-number">2.1.</span> <span class="toc-text">python2 读写文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#与编码相关的方法"><span class="toc-number">3.</span> <span class="toc-text">与编码相关的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reference-Link"><span class="toc-number">4.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

      
  

      
<article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2016-01-16T04:26:38.000Z"><a href="/hexo_blog/2016/01/16/Python-2016-01-16-python-字符编码/">2016-01-16</a></time>
        
  
    <h1 class="title"><a href="/hexo_blog/2016/01/16/Python-2016-01-16-python-字符编码/">python-字符编码</a></h1>
  

    </header>

    <div class="entry">
      
          <!--
       
              <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本介绍-python3的字符串编码"><span class="toc-number">1.</span> <span class="toc-text">基本介绍-python3的字符串编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#python3-中字符串编码的转换"><span class="toc-number">1.1.</span> <span class="toc-text">python3 中字符串编码的转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#python2-x-中的字符串编码转换"><span class="toc-number">1.2.</span> <span class="toc-text">python2.x 中的字符串编码转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#isinstance-判断"><span class="toc-number">1.3.</span> <span class="toc-text">isinstance 判断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#获取系统默认编码"><span class="toc-number">1.4.</span> <span class="toc-text">获取系统默认编码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#单字节的处理"><span class="toc-number">1.5.</span> <span class="toc-text">单字节的处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#codecs-模块简介"><span class="toc-number">2.</span> <span class="toc-text">codecs 模块简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#python2-读写文件"><span class="toc-number">2.1.</span> <span class="toc-text">python2 读写文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#与编码相关的方法"><span class="toc-number">3.</span> <span class="toc-text">与编码相关的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reference-Link"><span class="toc-number">4.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

                  

                  -->
        <h3 id="基本介绍-python3的字符串编码"><a href="#基本介绍-python3的字符串编码" class="headerlink" title="基本介绍-python3的字符串编码"></a>基本介绍-python3的字符串编码</h3><p>在 Python 2 中，字符串分为 ASCII 码表示（‘some text’）和 Unicode 表示（u‘Unicode 字符串’），默认为 ASCII 码。</p>
<p>不过在 Python 3 中，默认就是万能的 Unicode 码了，所以字符串前面不用加字母 u 也可以写 Unicode 了，当然这不是重点，重点是不会有各种 ASCII 和 Unicode 转换和混用带来的错误了。</p>
<p>另外， <strong>Python 3 中增加了一种 bytes 对象</strong>（b‘\xb6\xfe\xbd\xf8\xd6\xc6\xca\xfd\xbe\xdd’），专门用来表示编码后的（二进制）数据，所以现在对字符串的编码就是从 str 到 bytes 的转换，反之亦然</p>
<ul>
<li>bytes(<em>pytho3新增对象</em>)<ul>
<li>在网络上传输</li>
<li>保存到磁盘</li>
<li>python: bytes类型以 b 前缀打头。</li>
</ul>
</li>
<li>Unicode<ul>
<li>计算机内存</li>
<li>python3 str: 以unicode保存</li>
<li>python2 str: str类型需以 u 前缀打头表示unicode类型</li>
</ul>
</li>
<li>utf-8,ascii,gbk,etc…<ul>
<li>保存到硬盘，传输</li>
<li>python3源代码: 默认假定.py源代码以utf-8保存，<code># -*- coding: utf-8 -*-</code>告诉python解释器，按照<code>utf-8</code>读取源代码 </li>
</ul>
</li>
</ul>
<h4 id="python3-中字符串编码的转换"><a href="#python3-中字符串编码的转换" class="headerlink" title="python3 中字符串编码的转换"></a>python3 中字符串编码的转换</h4><p>在Python3中，每個字串都是Unicode，不使用內部编码表現，而使用str实例作為代表。如果想将字串转为指定的编码，可以使用<code>encode()</code>方法取得一個bytes实例，如果有個bytes实例，也可以使用<code>decode()</code>方法指定编码取得str实例：</p>
<pre><code>&gt;&gt;&gt; &apos;元&apos;.encode(&apos;big5&apos;)
b&apos;\xa4\xb8&apos;
&gt;&gt;&gt; &apos;元&apos;.encode(&apos;utf-8&apos;)
b&apos;\xe5\x85\x83&apos;
&gt;&gt;&gt; &apos;元&apos;.encode(&apos;big5&apos;).decode(&apos;big5&apos;)
&apos;元&apos;
</code></pre><p><img src="images/python/string-encoding-python3.jpg" alt=""></p>
<p><em>python3的<code>print</code>函数只支持<code>unicode</code>的str，貌似没有对bytes的解码功能，所以对对不能解码的bytes不能正确输出。</em></p>
<h4 id="python2-x-中的字符串编码转换"><a href="#python2-x-中的字符串编码转换" class="headerlink" title="python2.x 中的字符串编码转换"></a>python2.x 中的字符串编码转换</h4><p><strong>在编码转换时通常需要以unicode作为中间编码</strong><br>先将其他编码的字符串解码(decode)成unicode，再从unicode编码(encode)成另一种编码</p>
<ol>
<li>decode的作用是将其他编码的字符串转换成unicode编码</li>
<li>encode的作用是将unicode编码转换成其他编码的字符串</li>
</ol>
<p>比如从文件读入utf-8编码格式的字符串s，</p>
<pre><code>s.decode(&quot;utf-8&quot;, &quot;ignore&quot;).encode(&quot;gbk&quot;, &quot;ignore&quot;) # 先由utf-8转为unicode，再由unicode转为gbk，ignore表示忽略非法字符

&gt;&gt;&gt; b&apos;ABC&apos;.decode(&apos;ascii&apos;)
&apos;ABC&apos;
&gt;&gt;&gt; b&apos;\xe4\xb8\xad\xe6\x96\x87&apos;.decode(&apos;utf-8&apos;)
&apos;中文&apos;
</code></pre><h4 id="isinstance-判断"><a href="#isinstance-判断" class="headerlink" title="isinstance 判断"></a>isinstance 判断</h4><pre><code>def TestisStrOrUnicdeOrString():
  bs = b&apos;Hello&apos;
  ustr = &apos;abc&apos;
  print (isinstance(bs, str))  #False
  print (isinstance(bs,bytes)) #True
  print (isinstance(ustr,str)) #True
  print (isinstance(ustr, bytes)) #False
  print (isinstance(bs,(bytes,str))) #True
</code></pre><h4 id="获取系统默认编码"><a href="#获取系统默认编码" class="headerlink" title="获取系统默认编码"></a>获取系统默认编码</h4><p>Python3中默认是UTF-8，我们通过以下代码：</p>
<pre><code>import sys
sys.getdefaultencoding()
# &apos;uft-8&apos;
</code></pre><h4 id="单字节的处理"><a href="#单字节的处理" class="headerlink" title="单字节的处理"></a>单字节的处理</h4><ol>
<li><p>ord():<code>ord(&#39;A&#39;) == 65</code></p>
</li>
<li><p>chr():<code>chr(65) == &#39;A&#39;</code></p>
</li>
</ol>
<h3 id="codecs-模块简介"><a href="#codecs-模块简介" class="headerlink" title="codecs 模块简介"></a>codecs 模块简介</h3><p>codecs是encoders和decoders的缩写。</p>
<p>codecs模块为我们解决的字符编码的处理提供了lookup方法，它接受一个字符编码名称的参数，并返回指定字符编码对应的codecs.CodecInfo 对象，该对象包含了 encoder、decoder、StreamReader和StreamWriter的函数对象和类对象的引用。为了简化对lookup方法的调用， codecs还提供了getencoder(encoding)、getdecoder(encoding)、getreader(encoding)和 getwriter(encoding)方法；进一步，简化对特定字符编码的StreamReader、StreamWriter和 StreamReaderWriter的访问，codecs更直接地提供了open方法，通过encoding参数传递字符编码名称，即可获得对 encoder和decoder的双向服务。</p>
<p>这个模块的强大之处在于它提供了流的方式来处理字符串编码，当处理的数据很多时，这种方式很有用。<br>你可以使用IncrementalEncoder和IncrementalDecoder，但是强烈建议使用StreamReader和StreamWriter，因为使用它们会大大简化你的代码。</p>
<p>例如，有一个test.txt的文件，它的编码为gbk，现在我需要将它的编码转换为utf8，可以编写如下代码：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment">#coding:utf8</span></div><div class="line"><span class="keyword">import</span> codecs</div><div class="line"><span class="comment"># 打开文件 如果此处用codecs.open()方法打开文件，就不用创建reader和writer </span></div><div class="line">fin = open(<span class="string">'test.txt'</span>, <span class="string">'r'</span>) </div><div class="line">fout = open(<span class="string">'utf8.txt'</span>, <span class="string">'w'</span>) </div><div class="line"><span class="comment"># 获取 StreamReader </span></div><div class="line">reader = codecs.getreader(<span class="string">'gbk'</span>)(fin) </div><div class="line"><span class="comment"># 获取 StreamWriter </span></div><div class="line">writer = codecs.getwriter(<span class="string">'utf8'</span>)(fout) </div><div class="line">din = reader.read(<span class="number">10</span>) </div><div class="line"><span class="keyword">while</span> din: </div><div class="line">    writer.write(din) </div><div class="line">    din = reader.read(<span class="number">10</span>)</div></pre></td></tr></table></figure>
<p><em>用codecs提供的open方法来指定打开的文件的语言编码，它会在读取的时候自动转换为内部unicode</em></p>
<h4 id="python2-读写文件"><a href="#python2-读写文件" class="headerlink" title="python2 读写文件"></a>python2 读写文件</h4><p>内置的open()方法打开文件时，read()读取的是str，读取后需要使用正确的编码格式进行decode()。write()写入时，如果参数是unicode，则需要使用你希望写入的编码进行encode()，如果是其他编码格式的str，则需要先用该str的编码进行decode()，转成unicode后再使用写入的编码进行encode()。如果直接将unicode作为参数传入write()方法，Python将先使用源代码文件声明的字符编码进行编码然后写入。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"># coding: UTF-8</div><div class="line"> </div><div class="line">f = open(&apos;test.txt&apos;)</div><div class="line">s = f.read()</div><div class="line">f.close()</div><div class="line">print type(s) # &lt;type &apos;str&apos;&gt;</div><div class="line"># 已知是GBK编码，解码成unicode</div><div class="line">u = s.decode(&apos;GBK&apos;)</div><div class="line"> </div><div class="line">f = open(&apos;test.txt&apos;, &apos;w&apos;)</div><div class="line"># 编码成UTF-8编码的str</div><div class="line">s = u.encode(&apos;UTF-8&apos;)</div><div class="line">f.write(s)</div><div class="line">f.close()</div></pre></td></tr></table></figure>
<p>另外，模块codecs提供了一个open()方法，可以指定一个编码打开文件，使用这个方法打开的文件读取返回的将是unicode。写入时，如果参数是unicode，则使用open()时指定的编码进行编码后写入；如果是str，则先根据源代码文件声明的字符编码，解码成unicode后再进行前述操作。相对内置的open()来说，这个方法比较不容易在编码上出现问题。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"># coding: GBK</div><div class="line">import codecs</div><div class="line"> </div><div class="line">f = codecs.open(&apos;test.txt&apos;, encoding=&apos;UTF-8&apos;)</div><div class="line">u = f.read()</div><div class="line">f.close()</div><div class="line">print type(u) # &lt;type &apos;unicode&apos;&gt;</div><div class="line"> </div><div class="line">f = codecs.open(&apos;test.txt&apos;, &apos;a&apos;, encoding=&apos;UTF-8&apos;)</div><div class="line"># 写入unicode</div><div class="line">f.write(u)</div><div class="line"> </div><div class="line"># 写入str，自动进行解码编码操作</div><div class="line"># GBK编码的str</div><div class="line">s = &apos;汉&apos;</div><div class="line">print repr(s) # &apos;\xba\xba&apos;</div><div class="line"># 这里会先将GBK编码的str解码为unicode再编码为UTF-8写入</div><div class="line">f.write(s) </div><div class="line">f.close()</div></pre></td></tr></table></figure>
<h3 id="与编码相关的方法"><a href="#与编码相关的方法" class="headerlink" title="与编码相关的方法"></a>与编码相关的方法</h3><p>sys/locale模块中提供了一些获取当前环境下的默认编码的方法。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"># coding:gbk</div><div class="line"> </div><div class="line">import sys</div><div class="line">import locale</div><div class="line"> </div><div class="line">def p(f):</div><div class="line">    print &apos;%s.%s(): %s&apos; % (f.__module__, f.__name__, f())</div><div class="line"> </div><div class="line"># 返回当前系统所使用的默认字符编码</div><div class="line">p(sys.getdefaultencoding)</div><div class="line"> </div><div class="line"># 返回用于转换Unicode文件名至系统文件名所使用的编码</div><div class="line">p(sys.getfilesystemencoding)</div><div class="line"> </div><div class="line"># 获取默认的区域设置并返回元祖(语言, 编码)</div><div class="line">p(locale.getdefaultlocale)</div><div class="line"> </div><div class="line"># 返回用户设定的文本数据编码</div><div class="line"># 文档提到this function only returns a guess</div><div class="line">p(locale.getpreferredencoding)</div><div class="line"> </div><div class="line"># \xba\xba是&apos;汉&apos;的GBK编码</div><div class="line"># mbcs是不推荐使用的编码，这里仅作测试表明为什么不应该用</div><div class="line">print r&quot;&apos;\xba\xba&apos;.decode(&apos;mbcs&apos;):&quot;, repr(&apos;\xba\xba&apos;.decode(&apos;mbcs&apos;))</div><div class="line"> </div><div class="line">#在笔者的Windows上的结果(区域设置为中文(简体, 中国))</div><div class="line">#sys.getdefaultencoding(): gbk</div><div class="line">#sys.getfilesystemencoding(): mbcs</div><div class="line">#locale.getdefaultlocale(): (&apos;zh_CN&apos;, &apos;cp936&apos;)</div><div class="line">#locale.getpreferredencoding(): cp936</div><div class="line">#&apos;\xba\xba&apos;.decode(&apos;mbcs&apos;): u&apos;\u6c49&apos;</div></pre></td></tr></table></figure>
<h3 id="Reference-Link"><a href="#Reference-Link" class="headerlink" title="Reference Link"></a>Reference Link</h3><ol>
<li><a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431664106267f12e9bef7ee14cf6a8776a479bdec9b9000" target="_blank" rel="external">字符串和编码-廖雪峰</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



    	

	
    		
    
      <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Reference-Link"><span class="toc-number">1.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

      
  

      
<article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2016-01-16T02:31:49.000Z"><a href="/hexo_blog/2016/01/16/Python-2016-01-16-python-返回函数/">2016-01-16</a></time>
        
  
    <h1 class="title"><a href="/hexo_blog/2016/01/16/Python-2016-01-16-python-返回函数/">python-返回函数</a></h1>
  

    </header>

    <div class="entry">
      
          <!--
       
              <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Reference-Link"><span class="toc-number">1.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

                  

                  -->
        <p>函数的返回值为函数</p>
<h3 id="Reference-Link"><a href="#Reference-Link" class="headerlink" title="Reference Link"></a>Reference Link</h3><ol>
<li><a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431835236741e42daf5af6514f1a8917b8aaadff31bf000" target="_blank" rel="external">返回函数-廖雪峰</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



    	

	
    		
    
      <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#python调用cmd命令"><span class="toc-number">1.</span> <span class="toc-text">python调用cmd命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串前缀"><span class="toc-number">2.</span> <span class="toc-text">字符串前缀</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reference-Link"><span class="toc-number">3.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

      
  

      
<article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2016-01-15T16:54:11.000Z"><a href="/hexo_blog/2016/01/16/Python-2016-01-16-python-common-issue/">2016-01-16</a></time>
        
  
    <h1 class="title"><a href="/hexo_blog/2016/01/16/Python-2016-01-16-python-common-issue/">python-common-issue</a></h1>
  

    </header>

    <div class="entry">
      
          <!--
       
              <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#python调用cmd命令"><span class="toc-number">1.</span> <span class="toc-text">python调用cmd命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串前缀"><span class="toc-number">2.</span> <span class="toc-text">字符串前缀</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reference-Link"><span class="toc-number">3.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

                  

                  -->
        <h3 id="python调用cmd命令"><a href="#python调用cmd命令" class="headerlink" title="python调用cmd命令"></a>python调用cmd命令</h3><p>Python调用cmd命令，比较常见的有两种方法：</p>
<p>第一种可以使用os.system(“cmd”)，如</p>
<pre><code>import os
os.system(&quot;ipconfig /all&quot;)
</code></pre><p>第二种可以使用Popen模块产生新的process，如</p>
<pre><code>import subprocess
proc = subprocess.Popen(&quot;ipconfig /all&quot;, shell = True)
proc.wait() # 等待子进程结束
</code></pre><p>但是我们要注意的是，Popen使用时shell参数的设置。一般情况下，需要加上<code>shell = True</code>。</p>
<h3 id="字符串前缀"><a href="#字符串前缀" class="headerlink" title="字符串前缀"></a>字符串前缀</h3><ul>
<li>r<ul>
<li>在Python的string前面加上‘r’， 是为了告诉编译器这个string是个raw string，不要转意backslash ‘\’ </li>
</ul>
</li>
</ul>
<h3 id="Reference-Link"><a href="#Reference-Link" class="headerlink" title="Reference Link"></a>Reference Link</h3><ul>
<li><a href="http://www.lining0806.com/python%E8%B0%83%E7%94%A8cmd%E5%91%BD%E4%BB%A4/" target="_blank" rel="external">fireling的数据空间|宁哥的小站 » Python调用cmd命令</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



    	

	
    		
    
      <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#pyenv管理不同的版本"><span class="toc-number">1.</span> <span class="toc-text">pyenv管理不同的版本</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#安装pyenv"><span class="toc-number">1.1.</span> <span class="toc-text">安装pyenv</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#安装Python"><span class="toc-number">1.2.</span> <span class="toc-text">安装Python</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#安装Python的依赖包"><span class="toc-number">1.3.</span> <span class="toc-text">安装Python的依赖包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看当前已经安装的python版本"><span class="toc-number">1.4.</span> <span class="toc-text">查看当前已经安装的python版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#设置全局的python版本"><span class="toc-number">1.5.</span> <span class="toc-text">设置全局的python版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#确认python版本"><span class="toc-number">1.6.</span> <span class="toc-text">确认python版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#参考链接"><span class="toc-number">1.7.</span> <span class="toc-text">参考链接</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pip包管理命令"><span class="toc-number">2.</span> <span class="toc-text">pip包管理命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#windows下pip的安装"><span class="toc-number">3.</span> <span class="toc-text">windows下pip的安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他"><span class="toc-number">4.</span> <span class="toc-text">其他</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#python-pip-Pillow-安装"><span class="toc-number">4.1.</span> <span class="toc-text">[python][pip][Pillow]安装</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#windows下lxml的安装"><span class="toc-number">5.</span> <span class="toc-text">windows下lxml的安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#matplotlib安装"><span class="toc-number">6.</span> <span class="toc-text">matplotlib安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Building-on-Linux"><span class="toc-number">6.1.</span> <span class="toc-text">Building on Linux</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#backend"><span class="toc-number">6.2.</span> <span class="toc-text">backend</span></a></li></ol></li></ol>
</div>

      
  

      
<article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2016-01-14T16:57:52.000Z"><a href="/hexo_blog/2016/01/15/Python-2016-01-15-python-IDE/">2016-01-15</a></time>
        
  
    <h1 class="title"><a href="/hexo_blog/2016/01/15/Python-2016-01-15-python-IDE/">python-IDE</a></h1>
  

    </header>

    <div class="entry">
      
          <!--
       
              <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#pyenv管理不同的版本"><span class="toc-number">1.</span> <span class="toc-text">pyenv管理不同的版本</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#安装pyenv"><span class="toc-number">1.1.</span> <span class="toc-text">安装pyenv</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#安装Python"><span class="toc-number">1.2.</span> <span class="toc-text">安装Python</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#安装Python的依赖包"><span class="toc-number">1.3.</span> <span class="toc-text">安装Python的依赖包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看当前已经安装的python版本"><span class="toc-number">1.4.</span> <span class="toc-text">查看当前已经安装的python版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#设置全局的python版本"><span class="toc-number">1.5.</span> <span class="toc-text">设置全局的python版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#确认python版本"><span class="toc-number">1.6.</span> <span class="toc-text">确认python版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#参考链接"><span class="toc-number">1.7.</span> <span class="toc-text">参考链接</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pip包管理命令"><span class="toc-number">2.</span> <span class="toc-text">pip包管理命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#windows下pip的安装"><span class="toc-number">3.</span> <span class="toc-text">windows下pip的安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他"><span class="toc-number">4.</span> <span class="toc-text">其他</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#python-pip-Pillow-安装"><span class="toc-number">4.1.</span> <span class="toc-text">[python][pip][Pillow]安装</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#windows下lxml的安装"><span class="toc-number">5.</span> <span class="toc-text">windows下lxml的安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#matplotlib安装"><span class="toc-number">6.</span> <span class="toc-text">matplotlib安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Building-on-Linux"><span class="toc-number">6.1.</span> <span class="toc-text">Building on Linux</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#backend"><span class="toc-number">6.2.</span> <span class="toc-text">backend</span></a></li></ol></li></ol>
</div>

                  

                  -->
        <h3 id="pyenv管理不同的版本"><a href="#pyenv管理不同的版本" class="headerlink" title="pyenv管理不同的版本"></a>pyenv管理不同的版本</h3><p>经常遇到这样的情况：</p>
<ul>
<li>系统自带的Python是2.6，自己需要Python 2.7中的某些特性；</li>
<li>系统自带的Python是2.x，自己需要Python 3.x；<br>此时需要在系统中安装多个Python，但又不能影响系统自带的Python，即需要实现Python的多版本共存。pyenv就是这样一个Python版本管理器。</li>
</ul>
<h4 id="安装pyenv"><a href="#安装pyenv" class="headerlink" title="安装pyenv"></a>安装pyenv</h4><pre><code>$ git clone git://github.com/yyuu/pyenv.git ~/.pyenv
$ echo &apos;export PYENV_ROOT=&quot;$HOME/.pyenv&quot;&apos; &gt;&gt; ~/.bashrc
$ echo &apos;export PATH=&quot;$PYENV_ROOT/bin:$PATH&quot;&apos; &gt;&gt; ~/.bashrc
$ echo &apos;eval &quot;$(pyenv init -)&quot;&apos; &gt;&gt; ~/.bashrc
$ exec $SHELL -l
</code></pre><h4 id="安装Python"><a href="#安装Python" class="headerlink" title="安装Python"></a>安装Python</h4><p>查看可安装的版本</p>
<pre><code>$ pyenv install --list
</code></pre><p>该命令会列出可以用pyenv安装的Python版本，仅列举几个:</p>
<pre><code>2.7.8   # Python 2最新版本
3.4.1   # Python 3最新版本
anaconda-2.0.1  # 支持Python 2.6和2.7
anaconda3-2.0.1 # 支持Python 3.3和3.4
</code></pre><p>其中形如 x.x.x 这样的只有版本号的为Python官方版本，其他的形如 xxxxx-x.x.x 这种既有名称又有版本后的属于“衍生版”或发行版。</p>
<h4 id="安装Python的依赖包"><a href="#安装Python的依赖包" class="headerlink" title="安装Python的依赖包"></a>安装Python的依赖包</h4><p>如果我们确定要安装python3.4.3的话，接下来我们就可以安装python了，但是再安装之前，我们必须要安装python所需要的依赖包，这个必须要安装，安装会失败的：</p>
<pre><code>sudo apt-get install libc6-dev gcc
sudo apt-get install -y make build-essential libssl-dev zlib1g-dev libbz2-dev libreadline-dev libsqlite3-dev wget curl llvm
</code></pre><p>上面的依赖包搞定之后，我们就可以安装python了：</p>
<pre><code>pyenv install 3.4.3 -v
</code></pre><p>该命令会从github上下载python的源代码，并解压到/tmp目录下，然后在/tmp中执行编译工作。若依赖包没有安装，则会出现编译错误，需要在安装依赖包滞后重新执行该命令。</p>
<p>安装完成之后，需要使用如下命令对数据库进行更新：</p>
<pre><code>pyenv rehash
</code></pre><h4 id="查看当前已经安装的python版本"><a href="#查看当前已经安装的python版本" class="headerlink" title="查看当前已经安装的python版本"></a>查看当前已经安装的python版本</h4><pre><code>$ pyenv versions
* system (set by /home/seisman/.pyenv/version)
3.4.3
</code></pre><p>其中星号代表是当前系统正在使用的python版本是系统自带的。</p>
<h4 id="设置全局的python版本"><a href="#设置全局的python版本" class="headerlink" title="设置全局的python版本"></a>设置全局的python版本</h4><pre><code>$ pyenv global 3.4.3
$ pyenv versions
system
* 3.4.3 (set by /home/seisman/.pyenv/version)
</code></pre><p>从上面，我们可以看出来当前的python版本已经变为了3.4.3。也可以使用pyenv local或pyenv shell临时改变python的版本。</p>
<h4 id="确认python版本"><a href="#确认python版本" class="headerlink" title="确认python版本"></a>确认python版本</h4><pre><code>$ python
Python 3.4.3 (default, Apr  1 2015, 19:10:43) 
[GCC 4.8.2] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
</code></pre><p>注意事项：</p>
<p>使用python<br>输入 python 即可使用新版本的python；<br>系统自带的脚本会以 /usr/bin/python 的方式直接调用老版本的python，因而不会对系统脚本产生影响；<br>使用 pip 安装第三方模块时会安装到 ~/.pyenv/versions/3.4.1 下，不会和系统模块发生冲突。<br>使用 pip 安装模块后，可能需要执行 <code>pyenv rehash</code> 更新数据库；</p>
<h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><ol>
<li><a href="http://seisman.info/python-pyenv.html" target="_blank" rel="external">python多版本共存之pyenv</a></li>
</ol>
<h3 id="pip包管理命令"><a href="#pip包管理命令" class="headerlink" title="pip包管理命令"></a>pip包管理命令</h3><ol>
<li>install                     Install packages.  </li>
<li>uninstall                   Uninstall packages.  </li>
<li>freeze                      Output installed packages in requirements format.  </li>
<li>list                        List installed packages.  </li>
<li>show                        Show information about installed packages.  </li>
<li>search                      Search PyPI for packages.  </li>
<li>wheel                       Build wheels from your requirements.  </li>
<li>zip                         DEPRECATED. Zip individual packages.  </li>
<li>unzip                       DEPRECATED. Unzip individual packages.  </li>
<li>help                       Show help for commands.  </li>
</ol>
<h3 id="windows下pip的安装"><a href="#windows下pip的安装" class="headerlink" title="windows下pip的安装"></a>windows下pip的安装</h3><p>pip也可以在Windows下安装，使用也和linux下一样简单。</p>
<p>先从下面的地址下载pip源码<code>source</code>：</p>
<p><a href="http://pypi.python.org/pypi/pip/" target="_blank" rel="external">http://pypi.python.org/pypi/pip/</a></p>
<p>下载下来后解压，打开命令行：</p>
<ol>
<li><p>利用cd命令进入pip源码目录，假设源码放在F:\python\pip-6.0.8，则执行下面的命令：</p>
<pre><code>cd f:\python\pip-6.0.8  
</code></pre></li>
<li><p>在安装前必须确保python的路径已经加入到系统的PATH环境变量中，如果没有，可以用下面的命令来指定：</p>
<pre><code>set PATH=%PATH%;&quot;your python install path&quot;  
</code></pre></li>
<li><p>再运行下面的命令进行安装：</p>
<pre><code>python setup.py install  
</code></pre><p>等待片刻，一堆打印过后即可安装成功。</p>
</li>
</ol>
<p>要安装python包也很简单，只要运行命令：</p>
<pre><code>python -m pip install &lt;package name&gt;  
</code></pre><p>如要安装mysql的python支持包，可执行下面的命令：</p>
<pre><code>python -m pip install mysql  
</code></pre><p>完整的pip命令如下：</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><h4 id="python-pip-Pillow-安装"><a href="#python-pip-Pillow-安装" class="headerlink" title="[python][pip][Pillow]安装"></a>[python][pip][Pillow]安装</h4><p>环境：python 3.4.3, Ubuntu 14.04</p>
<p>直接运行命令</p>
<pre><code>pip install Pillow
</code></pre><p>如果出现以下错误：</p>
<pre><code>ValueError: --enable-jpeg requested but jpeg not found, aborting.
</code></pre><p>说明没有安装Jpeg的底包</p>
<p>安装:</p>
<pre><code>sudo apt-get install libjpeg-dev
</code></pre><p>然后继续安装即可</p>
<h3 id="windows下lxml的安装"><a href="#windows下lxml的安装" class="headerlink" title="windows下lxml的安装"></a>windows下lxml的安装</h3><p>背景：在cmd命令下直接使用<code>pip3 install lxml</code>会出现缺少VC++依赖库的提示。</p>
<p>可直接下载二进制包安装</p>
<p>作者：深海鱼<br>链接：[<a href="http://www.zhihu.com/question/26857761/answer/69754633" target="_blank" rel="external">http://www.zhihu.com/question/26857761/answer/69754633</a>]<br>来源：知乎</p>
<ol>
<li>安装wheel，命令行运行：<code>pip3 install wheel</code></li>
<li><p>在这里下载对应的.whl文件，注意别改文件名！[<a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/#lxml" target="_blank" rel="external">http://www.lfd.uci.edu/~gohlke/pythonlibs/#lxml</a>]<br>Ctrl+F，输入lxml，找到</p>
<pre><code>Lxml, a binding for the libxml2 and libxslt libraries.
lxml-3.4.4-cp27-none-win32.whl
lxml-3.4.4-cp27-none-win_amd64.whl
lxml-3.4.4-cp34-none-win32.whl
lxml-3.4.4-cp34-none-win_amd64.whl
lxml-3.4.4-cp35-none-win32.whl
lxml-3.4.4-cp35-none-win_amd64.whl
lxml-3.5.0-cp27-none-win32.whl
lxml-3.5.0-cp27-none-win_amd64.whl
lxml-3.5.0-cp34-none-win32.whl
lxml-3.5.0-cp34-none-win_amd64.whl
lxml-3.5.0-cp35-none-win32.whl
lxml-3.5.0-cp35-none-win_amd64.whl
</code></pre><p>cp后面是Python的版本号，27表示2.7，amd64表示64位系统，根据你的Python版本选择下载。</p>
</li>
<li>进入.whl所在的文件夹，执行命令即可完成安装<code>pip install 带后缀的完整文件名</code></li>
</ol>
<h3 id="matplotlib安装"><a href="#matplotlib安装" class="headerlink" title="matplotlib安装"></a>matplotlib安装</h3><p>参考链接 ： </p>
<ol>
<li><a href="http://matplotlib.org/users/installing.html" target="_blank" rel="external">官方文档</a></li>
</ol>
<p><strong> Build requirements </strong><br>These are external packages which you will need to install before installing matplotlib.</p>
<p>If you are installing dependencies with a package manager on Linux, you may need to install the development packages (look for a “-de”” postf) in addition to the librari themselves</p>
<h4 id="Building-on-Linux"><a href="#Building-on-Linux" class="headerlink" title="Building on Linux"></a>Building on Linux</h4><p>It is easiest to use your system package manager to install the dependencies.</p>
<p>If you are on Debian/Ubuntu, you can get all the dependencies required to build matplotlib with:</p>
<pre><code>sudo apt-get build-dep python-matplotlib
</code></pre><p>This does not build matplotlib, but it does get the install the build dependencies, which will make building from source easier.</p>
<p>然后使用pip install matplotlib即可</p>
<h4 id="backend"><a href="#backend" class="headerlink" title="backend"></a>backend</h4><p>I had the same issue, and installing matplotlib using easy_install instead of pip did not solve it. In the end, I found out that the problem was simply that matplotlib could not find any backend for plotting.</p>
<p>I solved it by doing the following (I am using Debian wheezy):</p>
<pre><code>pip uninstall matplotlib
sudo apt-get install tcl-dev tk-dev
pip install matplotlib
</code></pre>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



    	

	
    		
    
      <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#ubuntu下git-status的中文乱码解决"><span class="toc-number">1.</span> <span class="toc-text">ubuntu下git status的中文乱码解决</span></a></li></ol>
</div>

      
  

      
<article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2016-01-14T16:05:09.000Z"><a href="/hexo_blog/2016/01/15/Git-2016-01-15-git-common-issue/">2016-01-15</a></time>
        
  
    <h1 class="title"><a href="/hexo_blog/2016/01/15/Git-2016-01-15-git-common-issue/">git常见问题</a></h1>
  

    </header>

    <div class="entry">
      
          <!--
       
              <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#ubuntu下git-status的中文乱码解决"><span class="toc-number">1.</span> <span class="toc-text">ubuntu下git status的中文乱码解决</span></a></li></ol>
</div>

                  

                  -->
        <h3 id="ubuntu下git-status的中文乱码解决"><a href="#ubuntu下git-status的中文乱码解决" class="headerlink" title="ubuntu下git status的中文乱码解决"></a>ubuntu下git status的中文乱码解决</h3><p>只要一行就行了</p>
<pre><code>git config --global core.quotepath false
</code></pre><p>对比效果图<br><img src="images/Git/git-status-chinese-messy.jpg" alt="git-status-chinese-messy"></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



    	

	
    		
    
      <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#clone-某特定分支"><span class="toc-number">1.</span> <span class="toc-text">clone 某特定分支</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#git-fetch-远程仓库至本地，并重新命名"><span class="toc-number">2.</span> <span class="toc-text">git fetch 远程仓库至本地，并重新命名</span></a></li></ol>
</div>

      
  

      
<article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2016-01-14T07:11:16.000Z"><a href="/hexo_blog/2016/01/14/Git-2016-01-14-git-clone-remote/">2016-01-14</a></time>
        
  
    <h1 class="title"><a href="/hexo_blog/2016/01/14/Git-2016-01-14-git-clone-remote/">git clone 远程仓库的切换</a></h1>
  

    </header>

    <div class="entry">
      
        <h2 id="clone-某特定分支"><a href="#clone-某特定分支" class="headerlink" title="clone 某特定分支"></a>clone 某特定分支</h2><pre><code>git clone -b &lt;branch&gt; &lt;remote_repo&gt;
</code></pre><p>或者：</p>
<p>git clone只能clone远程库的master分支，无法clone所有分支，解决办法如下：</p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/hexo_blog/2016/01/14/Git-2016-01-14-git-clone-remote/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



    	

	
    		
    
      <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#版本回退"><span class="toc-number">1.</span> <span class="toc-text">版本回退</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#git-reset-的参数说明"><span class="toc-number">1.1.</span> <span class="toc-text">git reset 的参数说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#修复已提交文件中的错误"><span class="toc-number">1.2.</span> <span class="toc-text">修复已提交文件中的错误</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-log"><span class="toc-number">2.</span> <span class="toc-text">git log</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-commit-a"><span class="toc-number">3.</span> <span class="toc-text">git commit -a</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-diff"><span class="toc-number">4.</span> <span class="toc-text">git diff</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-checkout-–-file-文件快照的回退"><span class="toc-number">5.</span> <span class="toc-text">git checkout – file 文件快照的回退</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#git-reset与checkout的区别"><span class="toc-number">5.1.</span> <span class="toc-text">git reset与checkout的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-commit-–ammend-修改已经提交的注释"><span class="toc-number">6.</span> <span class="toc-text">git commit –ammend 修改已经提交的注释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reference-Link"><span class="toc-number">7.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

      
  

      
<article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2016-01-11T17:37:42.000Z"><a href="/hexo_blog/2016/01/12/Git-2016-01-12-git-time-machine/">2016-01-12</a></time>
        
  
    <h1 class="title"><a href="/hexo_blog/2016/01/12/Git-2016-01-12-git-time-machine/">git时光穿梭机</a></h1>
  

    </header>

    <div class="entry">
      
          <!--
       
              <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#版本回退"><span class="toc-number">1.</span> <span class="toc-text">版本回退</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#git-reset-的参数说明"><span class="toc-number">1.1.</span> <span class="toc-text">git reset 的参数说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#修复已提交文件中的错误"><span class="toc-number">1.2.</span> <span class="toc-text">修复已提交文件中的错误</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-log"><span class="toc-number">2.</span> <span class="toc-text">git log</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-commit-a"><span class="toc-number">3.</span> <span class="toc-text">git commit -a</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-diff"><span class="toc-number">4.</span> <span class="toc-text">git diff</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-checkout-–-file-文件快照的回退"><span class="toc-number">5.</span> <span class="toc-text">git checkout – file 文件快照的回退</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#git-reset与checkout的区别"><span class="toc-number">5.1.</span> <span class="toc-text">git reset与checkout的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-commit-–ammend-修改已经提交的注释"><span class="toc-number">6.</span> <span class="toc-text">git commit –ammend 修改已经提交的注释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reference-Link"><span class="toc-number">7.</span> <span class="toc-text">Reference Link</span></a></li></ol>
</div>

                  

                  -->
        <p>master: 默认开发分支</p>
<p>origin: 默认远程版本库</p>
<p>Head: 默认开发分支，当前版本</p>
<p>Head^: Head的父提交</p>
<p>Head~1 同 Head^</p>
<h3 id="版本回退"><a href="#版本回退" class="headerlink" title="版本回退"></a>版本回退</h3><blockquote>
<p>  <a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/0013744142037508cf42e51debf49668810645e02887691000" target="_blank" rel="external">版本回退-廖雪峰</a><br>  如果要把当前版本回退到上一个版本，可以使用以下命令：</p>
<pre><code>git reset --hard HEAD^
</code></pre><p>  现在，你回退到了某个版本，关掉了电脑，第二天早上就后悔了，想恢复到新版本怎么办？找不到新版本的commit id怎么办？<br>  在Git中，总是有后悔药可以吃的。当你用<code>$ git reset --hard HEAD^</code>回退到add distributed版本时，再想恢复到append GPL，就必须找到append GPL的commit id。Git提供了一个命令<code>git reflog</code>用来记录你的每一次命令：</p>
<pre><code>$ git reflog
ea34578 HEAD@{0}: reset: moving to HEAD^
3628164 HEAD@{1}: commit: append GPL
ea34578 HEAD@{2}: commit: add distributed
cb926e7 HEAD@{3}: commit (initial): wrote a readme file
</code></pre></blockquote>
<h4 id="git-reset-的参数说明"><a href="#git-reset-的参数说明" class="headerlink" title="git reset 的参数说明"></a>git reset 的参数说明</h4><p>git reset用于撤销未被提交到远端的改动。除了可以移动当前分支的HEAD，你可以通过不同的标记选择修改 staged snapshot 或者 working directory</p>
<ul>
<li>–soft： 暂存区(staged snapshot)和 工作区(working directory) 都未被改变 (建议在命令行执行后，再输入 git status 查看状态)</li>
<li>–mixed： staged snapshot 被更新， working directory 未被更改。【这是默认选项】（建议同上)</li>
<li>–hard： staged snapshot 和 working directory 都将回退。<br>–hard 很危险，它会直接回退你之前所有的修改，使用前，可以事先保存 commit id.</li>
</ul>
<p>【这些标记经常和HEAD一起使用。例如，<code>git reset --mixed HEAD</code>可撤销所有缓存改动，但是保留他们在工作目录下。<code>git reset --hard HEAD</code>可彻底删除没有提交的改动。】</p>
<h4 id="修复已提交文件中的错误"><a href="#修复已提交文件中的错误" class="headerlink" title="修复已提交文件中的错误"></a>修复已提交文件中的错误</h4><ul>
<li><p>创建新提交来修复错误<br>创建一个新的，撤消(revert)了前期修改的提交(commit)是很容易的; 只要把出错的提交(commit)的名字(reference)做为参数传给命令: git revert就可以了; 下面这条命令就演示了如何撤消最近的一个提交:</p>
<pre><code>$ git revert HEAD
</code></pre><p>这样就创建了一个撤消了上次提交(HEAD)的新提交, 你就有机会来修改新提交(new commit)里的提交注释信息.</p>
</li>
</ul>
<h3 id="git-log"><a href="#git-log" class="headerlink" title="git log"></a>git log</h3><ul>
<li><p>git log查看历史版本</p>
<pre><code>git log --graph --pretty=oneline --abbrev-commit        #用带参数的git log也可以看到分支的合并情况：  
</code></pre></li>
</ul>
<h3 id="git-commit-a"><a href="#git-commit-a" class="headerlink" title="git commit -a"></a>git commit -a</h3><p>跳过git stage命令，直接递交修改和删除的文件，新建的文件不受影响，不会被加入暂存区</p>
<blockquote>
<p>  commit -a<br>  Tell the command to automatically stage files that have been modified and deleted, but new files you have not told git about are not affected.</p>
</blockquote>
<h3 id="git-diff"><a href="#git-diff" class="headerlink" title="git diff"></a>git diff</h3><p>当一个文件做了stage，然后又做了一些修改，则：</p>
<ul>
<li><code>git diff</code> 显示当前工作区的文件和stage区文件的差异</li>
<li><code>git diff --staged</code> 显示stage区和HEAD的文件的差异<ul>
<li><code>git diff --cached</code>==<code>git diff --staged</code>: 建议使用 git diff –staged 替代 git diff –cached</li>
</ul>
</li>
<li><code>git diff HEAD</code> 显示工作区和上次递交文件HEAD的差异 <ul>
<li><code>git diff HEAD -- readme.txt</code>命令可以查看工作区和版本库里面最新版本的区别</li>
</ul>
</li>
</ul>
<h3 id="git-checkout-–-file-文件快照的回退"><a href="#git-checkout-–-file-文件快照的回退" class="headerlink" title="git checkout – file 文件快照的回退"></a>git checkout – file 文件快照的回退</h3><p>当一个文件做了git stage，任何时候，都可以回退到stage的状态</p>
<pre><code>git checkout -- hellp.py
</code></pre><p>git checkout其实是用版本库里的版本替换工作区的版本，无论工作区是修改还是删除，都可以一键还原</p>
<h4 id="git-reset与checkout的区别"><a href="#git-reset与checkout的区别" class="headerlink" title="git reset与checkout的区别"></a>git reset与checkout的区别</h4><p>当文件加入了 stage 区以后，如果要从stage删除，则使用 reset,此时工作区的文件不做任何修改，</p>
<p>比如：<code>git reset hello.py</code>这个命令就是 <code>git stage hello.py</code> 的反操作。</p>
<p>当文件加入了 stage 区以后，后来又做了一些修改，<br>这时发现后面的修改有问题，想回退到stage的状态，使用 checkout 命令：<code>git checkout hello.py</code></p>
<h3 id="git-commit-–ammend-修改已经提交的注释"><a href="#git-commit-–ammend-修改已经提交的注释" class="headerlink" title="git commit –ammend 修改已经提交的注释"></a>git commit –ammend 修改已经提交的注释</h3><p>对于已经修改提交过的注释，如果需要修改，可以借助<code>git commit --amend</code> 来进行。  </p>
<p>例如 在framework/base 里最新的提交就是 resolving the roaming problem，<br>我现在需要将其改为 resolving the roaming problem for fixing bug 7732<br>在 framework/base 下 输入 <code>git commit --amend</code>,就会进入一个文本编辑界面（如下）<br>在注释的地方修改 ，保存然后退出，这样注释就修改了，再重新push.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">resolving the roaming problem </div><div class="line"></div><div class="line">Change-Id: I7e7daffd2e8a5e65130629dc1c56dee5f5c4b5f7</div><div class="line"></div><div class="line"># Please enter the commit message for your changes. Lines starting</div><div class="line"># with &apos;#&apos; will be ignored, and an empty message aborts the commit.</div><div class="line"># On branch shuai.lu_branch</div><div class="line"># Changes to be committed:</div><div class="line">#   (use &quot;git reset HEAD^1 &lt;file&gt;...&quot; to unstage)</div><div class="line">#</div><div class="line">#       modified:   telephony/java/com/android/internal/telephony/gsm/GsmServic$</div><div class="line">#</div></pre></td></tr></table></figure>
<h3 id="Reference-Link"><a href="#Reference-Link" class="headerlink" title="Reference Link"></a>Reference Link</h3><ol>
<li><a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/0013743858312764dca7ad6d0754f76aa562e3789478044000" target="_blank" rel="external">时光机穿梭-廖雪峰</a></li>
<li><a href="https://www.zhihu.com/question/19946553/answer/13759819" target="_blank" rel="external">知乎回答-彭勇</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



    	

	
    		
    
      <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>

</div>

      
  

      
<article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2016-01-11T17:35:10.000Z"><a href="/hexo_blog/2016/01/12/Git-2016-01-12-git-resources/">2016-01-12</a></time>
        
  
    <h1 class="title"><a href="/hexo_blog/2016/01/12/Git-2016-01-12-git-resources/">Git常用命令速查表</a></h1>
  

    </header>

    <div class="entry">
      
          <!--
       
              <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>

</div>

                  

                  -->
        <p>###创建版本库</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ git clone &lt;url&gt;   #克隆远程版本库</div><div class="line">$ git init          #初始化本地版本库</div></pre></td></tr></table></figure>
<p>###修改和提交</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ git status        #查看状态</div><div class="line">$ git diff          #查看变更内容</div><div class="line">$ git add .         #跟踪所有改动过的文件</div><div class="line">$ git add &lt;file&gt;    #跟踪指定的文件</div><div class="line">$ git mv &lt;old&gt;&lt;new&gt; #文件改名</div><div class="line">$ git rm &lt;file&gt;     #删除文件</div><div class="line">$ git rm --cached&lt;file&gt;            #停止跟踪文件但不删除</div><div class="line">$ git commit -m &quot;commit messages&quot;  #提交所有更新过的文件</div><div class="line">$ git commit --amend               #修改最后一次改动</div></pre></td></tr></table></figure>
<p>###查看提交历史</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ git log                    #查看提交历史</div><div class="line">$ git log -p &lt;file&gt;          #查看指定文件的提交历史</div><div class="line">$ git blame &lt;file&gt;           #以列表方式查看指定文件的提交历史</div></pre></td></tr></table></figure>
<p>###撤销</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ git reset --hard HEAD      #撤销工作目录中所有未提交文件的修改内容</div><div class="line">$ git checkout HEAD &lt;file&gt;   #撤销指定的未提交文件的修改内容</div><div class="line">$ git revert &lt;commit&gt;        #撤销指定的提交</div><div class="line">$ git log --before=&quot;1 days&quot;  #退回到之前1天的版本</div></pre></td></tr></table></figure>
<p>###分支与标签</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ git branch                   #显示所有本地分支</div><div class="line">$ git branch -r                #显示远程跟踪分支</div><div class="line">$ git checkout --track -b refactored origin/refactored   # 基于远程分支refactored创建本地分支refactored</div><div class="line">$ git checkout &lt;branch/tag&gt;    #切换到指定分支和标签</div><div class="line">$ git branch &lt;new-branch&gt;      #创建新分支</div><div class="line">$ git branch -d &lt;branch&gt;       #删除本地分支</div><div class="line">$ git tag                      #列出所有本地标签</div><div class="line">$ git tag &lt;tagname&gt;            #基于最新提交创建标签</div><div class="line">$ git tag -d &lt;tagname&gt;         #删除标签</div></pre></td></tr></table></figure>
<p>###合并与衍合</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ git merge &lt;branch&gt;        #合并指定分支到当前分支</div><div class="line">$ git rebase &lt;branch&gt;       #衍合指定分支到当前分支</div><div class="line"></div><div class="line">$ git log --graph --pretty=oneline --abbrev-commit      #查看分支的合并情况</div></pre></td></tr></table></figure>
<p>###远程操作</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ git remote -v                   #查看远程版本库信息</div><div class="line">$ git remote show &lt;remote&gt;        #查看指定远程版本库信息</div><div class="line">$ git remote add &lt;remote&gt; &lt;url&gt;   #添加远程版本库</div><div class="line">$ git fetch &lt;remote&gt;              #从远程库获取代码</div><div class="line">$ git pull &lt;remote&gt; &lt;branch&gt;      #下载代码及快速合并</div><div class="line">$ git push &lt;remote&gt; &lt;branch&gt;      #上传代码及快速合并</div><div class="line">$ git push &lt;remote&gt; :&lt;branch/tag-name&gt;  #删除远程分支或标签</div><div class="line">$ git push --tags                       #上传所有标签</div><div class="line">$ git push origin experimental:experiment-by-bob  # 如果这个分支在远程仓库里对应不同的名称（如:experiment-by-bob）,可以这么做：</div></pre></td></tr></table></figure>
<p>###资料链接</p>
<ol>
<li><a href="https://try.github.io/levels/1/challenges/1" target="_blank" rel="external">Try Git</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



    	

	
    		
    
      <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Git-Submodules-Adding-Using-Removing-Updating"><span class="toc-number">1.</span> <span class="toc-text">Git Submodules: Adding, Using, Removing, Updating</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Adding-Submodules-to-a-Git-Repository"><span class="toc-number">1.1.</span> <span class="toc-text">Adding Submodules to a Git Repository</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-Submodules"><span class="toc-number">1.2.</span> <span class="toc-text">Using Submodules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Removing-Submodules"><span class="toc-number">1.3.</span> <span class="toc-text">Removing Submodules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Updating-Submodules"><span class="toc-number">1.4.</span> <span class="toc-text">Updating Submodules</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考链接"><span class="toc-number">2.</span> <span class="toc-text">参考链接</span></a></li></ol>
</div>

      
  

      
<article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2016-01-11T17:01:01.000Z"><a href="/hexo_blog/2016/01/12/Git-2016-01-12-Git-submodule/">2016-01-12</a></time>
        
  
    <h1 class="title"><a href="/hexo_blog/2016/01/12/Git-2016-01-12-Git-submodule/">zt-Git子模块的维护</a></h1>
  

    </header>

    <div class="entry">
      
          <!--
       
              <div class="openaside"><a class="navbutton" href="#" title="显示目录"></a></div>
<div id="toc" class="toc-aside">
  <strong class="toc-title"> 目录 </strong>
  <strong class="toc-title"> undefined </strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Git-Submodules-Adding-Using-Removing-Updating"><span class="toc-number">1.</span> <span class="toc-text">Git Submodules: Adding, Using, Removing, Updating</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Adding-Submodules-to-a-Git-Repository"><span class="toc-number">1.1.</span> <span class="toc-text">Adding Submodules to a Git Repository</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-Submodules"><span class="toc-number">1.2.</span> <span class="toc-text">Using Submodules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Removing-Submodules"><span class="toc-number">1.3.</span> <span class="toc-text">Removing Submodules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Updating-Submodules"><span class="toc-number">1.4.</span> <span class="toc-text">Updating Submodules</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考链接"><span class="toc-number">2.</span> <span class="toc-text">参考链接</span></a></li></ol>
</div>

                  

                  -->
        <h2 id="Git-Submodules-Adding-Using-Removing-Updating"><a href="#Git-Submodules-Adding-Using-Removing-Updating" class="headerlink" title="Git Submodules: Adding, Using, Removing, Updating"></a>Git Submodules: Adding, Using, Removing, Updating</h2><h3 id="Adding-Submodules-to-a-Git-Repository"><a href="#Adding-Submodules-to-a-Git-Repository" class="headerlink" title="Adding Submodules to a Git Repository"></a>Adding Submodules to a Git Repository</h3><p>Fortunately, adding a submodule to a git repository is actually quite simple. For example, if I’m in the repository working directory of a new theme called SampleTheme and need to add the billboard repository to the path lib/billboard, I can do so with the following command:</p>
<pre><code>[user@office SampleTheme]$ git submodule add git@mygithost:billboard lib/billboard
Initialized empty Git repository in ~/git_dev/SampleTheme/lib/billboard/.git/
remote: Counting objects: 1006, done.
remote: Compressing objects: 100% (978/978), done.
remote: Total 1006 (delta 631), reused 0 (delta 0)
Receiving objects: 100% (1006/1006), 408.22 KiB, done.
Resolving deltas: 100% (631/631), done.
There are three main parts to this command:
</code></pre><ul>
<li><code>git submodule add</code> – This simply tells Git that we are adding a submodule. This syntax will always remain the same.</li>
<li><code>git@mygithost:billboard</code> – This is the external repository that is to be added as a submodule. The exact syntax will vary depending on the setup of the Git repository you are connecting to. You need to ensure that you have the ability to clone the given repository.</li>
<li><p><code>lib/billboard</code> – This is the path where the submodule repository will be added to the main repository.<br>Let’s check to see how the repository is doing.</p>
<pre><code>[user@office SampleTheme]$ git status
# On branch master
# Changes to be committed:
#   (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)
#
#       new file:   .gitmodules
#       new file:   lib/billboard
#
</code></pre></li>
</ul>
<p>Notice how the supplied path was created and added to the changes to be committed. In addition, a new file called .gitmodules was created. This new file contains the details we supplied about the new submodule. Out of curiosity, let’s check out the contents of that new file:</p>
<pre><code>[user@office SampleTheme]$ cat .gitmodules
[submodule &quot;lib/billboard&quot;]
path = lib/billboard
url = git@mygithost:billboard
</code></pre><p>Being able to modify this file later will come in handy later.</p>
<p>All that is left to do now is to commit the changes and then push the commit to a remote system if necessary.</p>
<h3 id="Using-Submodules"><a href="#Using-Submodules" class="headerlink" title="Using Submodules"></a>Using Submodules</h3><p>Having submodules in a repository is great and all, but if I look in my repository, all I have is an empty folder rather than the actual contents of the submodule’s repository. In order to fill in the submodule’s path with the files from the external repository, you must first initialize the submodules and then update them.</p>
<blockquote>
<p>  Note: This has changed in newer versions of Git. Now the submodule’s repository will be cloned with master checked out. If that repository also has submodules, then your submodule’s submodules will have to be populated by following the steps below from within your project’s submodule directory (confusing yet?).</p>
<p>  For instance, if you are working in project called phone-app, add a submodule called graphics-lib, and graphics-lib has a submodule called renderer, when you add graphics-lib to phone-app, the phone-app/graphics-lib directory will be populated as a cloned repo but the phone-app/graphics-lib/renderer directory will be empty. To populate phone-app/graphics-lib/renderer, first change directories to phone-app/graphics-lib and follow the instructions below.</p>
</blockquote>
<p>First, we need to initialize the submodule(s). We can do that with the following command:</p>
<pre><code>[user@office SampleTheme]$ git submodule init
Submodule &apos;lib/billboard&apos; (git@mygithost:billboard) registered for path &apos;lib/billboard&apos;
</code></pre><p>Then we need to run the update in order to pull down the files.</p>
<pre><code>[user@office SampleTheme]$ git submodule update
Initialized empty Git repository in ~/git_dev/SampleTheme/lib/billboard/.git/
remote: Counting objects: 26, done.
remote: Compressing objects: 100% (22/22), done.
remote: Total 26 (delta 5), reused 0 (delta 0)
Receiving objects: 100% (26/26), 17.37 KiB, done.
Resolving deltas: 100% (5/5), done.
Submodule path &apos;lib/billboard&apos;: checked out &apos;1c407cb2315z0847facb57d79d680f88ca004332&apos;
Looking in the lib/billboard directory now shows a nice listing of the needed files.
</code></pre><h3 id="Removing-Submodules"><a href="#Removing-Submodules" class="headerlink" title="Removing Submodules"></a>Removing Submodules</h3><p>What happens if we need to remove a submodule? Maybe I made a mistake. It could also be that the design of the project has changed, and the submodules need to change with it. No problem, I’ll simply run<code>“git submodule rm [submodule path]</code> and everything will be great, right?</p>
<pre><code>[user@office SampleTheme]$ git submodule rm lib/billboard
error: pathspec &apos;rm&apos; did not match any file(s) known to git.
Did you forget to &apos;git add&apos;?
 b8ff8f68eb56938b9b4bf993619218fa848c5848 lib/billboard (1.2.25)
</code></pre><p>Unfortunately, this is wrong. Git does not have a built in way to remove submodules. Hopefully this will be resolved in the future, because we now have to do submodule removal manually.</p>
<p>Sticking with the example, we’ll remove the<code>lib/billboar</code>d module from SampleTheme. All the instructions will be run from the working directory of the SampleTheme repository. In order, we need to do the following:</p>
<ol>
<li><p>Remove the submodule’s entry in the <code>.gitmodules</code> file .Since lib/billboard is the only submodule in the SampleTheme repository, we can simply remove the file entirely by running <code>git rm lib/billboard</code>.If <code>lib/billboard</code> isn’t the only submodule, the .gitmodules file will have to be modified by hand. Open it up in vi, or your favorite text editory, and remove the three lines relevant to the submodule being removed. In this case, these lines will be removed:</p>
<pre><code>[submodule “lib/billboard”]
path = lib/billboard
url = git@mygithost:billboard
</code></pre></li>
<li><p>Remove the submodule’s entry in the .git/config. This step isn’t strictly necessary, but it does keep your config file tidy and will help prevent problems in the future.The submodule’s entry in .git/config will only be present if you’ve run “git submodule init” on the repository. If you haven’t, you can skip this step.In this example, the following lines will be removed:</p>
<pre><code>[submodule “billboard”]
url = git@mygithost:billboard
</code></pre></li>
<li><p>Remove the path created for the submodule. This one is easy. Simply run <code>git rm –cached[plugin path]</code>. In this example, I will run <code>git rm –cached lib/billboar</code>“.As I’ve seen noted elsewhere, do not put a trailing slash as the command will fail. For example, if I run <code>git rm –cached lib/billboard</code>“, I get an error” “fatal: pathspec <code>lib/billboard/</code> did not match any files”.</p>
<pre><code>[user@office SampleTheme]$ git rm --cached lib/billboard
rm &apos;lib/billboard&apos;
</code></pre></li>
</ol>
<h3 id="Updating-Submodules"><a href="#Updating-Submodules" class="headerlink" title="Updating Submodules"></a>Updating Submodules</h3><p>There is an aspect about submodules that some may not realize when first working with Git submodules. When you add the submodule, the most recent commit of the submodule is stored in the main repository’s index. That means that as the code in the submodule’s repository updates, the same code will still be pulled on the repositories relying on the submodule.</p>
<p>This makes a lot of sense when you consider how your code will have been tested and verified (or at least should be) against a specific version of the submodule code, but the main repository’s code may not work well with new submodule updates before the changes are tested.</p>
<p>Unfortunately, like removing submodules, Git does not make it clear how to update a submodule to a later commit. Fortunately though, it’s not that tough.</p>
<ol>
<li><p>Initialize the repository’s submodules by running “git submodule init” followed by “git submodule update“.</p>
<pre><code>[user@office SampleTheme]$ git submodule init
Submodule &apos;lib/billboard&apos; (git@mygithost:billboard) registered for path &apos;lib/billboard&apos;
[user@office SampleTheme]$ git submodule update
Initialized empty Git repository in ~/git_dev/SampleTheme/lib/billboard/.git/
remote: Counting objects: 26, done.
remote: Compressing objects: 100% (22/22), done.
remote: Total 26 (delta 5), reused 0 (delta 0)
Receiving objects: 100% (26/26), 17.37 KiB, done.
Resolving deltas: 100% (5/5), done.
Submodule path &apos;lib/billboard&apos;: checked out &apos;1c407cb2315z0847facb57d79d680f88ca004332&apos;
</code></pre></li>
<li><p>Change into the submodule’s directory. In this example, “cd lib/billboard“.</p>
<pre><code>[user@office SampleTheme]$ cd lib/billboard
[user@office SampleTheme/lib/billboard]$ 
</code></pre></li>
<li><p>The submodule repositories added by “git submodule update” are “headless”. This means that they aren’t on a current branch.To fix this, we simply need to switch to a branch. In this example, that would be the master branch. We switch with the following command: “git checkout master“.</p>
<pre><code>[user@office SampleTheme/lib/billboard]$ git status
# Not currently on any branch.
nothing to commit (working directory clean)
[user@office SampleTheme/lib/billboard]$ git checkout master
Previous HEAD position was b8ff8f6... re-ordering
Switched to branch &apos;master&apos;
Your branch is behind &apos;origin/master&apos; by 8 commits, and can be fast-forwarded.
[user@office SampleTheme/lib/billboard]$ git status
# On branch master
# Your branch is behind &apos;origin/master&apos; by 8 commits, and can be fast-forwarded.
#
nothing to commit (working directory clean)
</code></pre></li>
<li><p>Next, we simply need to update the repository to ensure that we have the latest updates. We can do that with a pull: <code>git pul</code>.</p>
<pre><code>[user@office SampleTheme/lib/billboard]$ git pull
remote: Counting objects: 31, done.
remote: Compressing objects: 100% (24/24), done.
remote: Total 24 (delta 15), reused 0 (delta 0)
Unpacking objects: 100% (24/24), done.
From mygithost:billboard
   b8ff8f6..5cab93f  master     -&gt; origin/master
 * [new tag]         1.2.28     -&gt; 1.2.28
From mygithost:billboard
 * [new tag]         1.2.26     -&gt; 1.2.26
 * [new tag]         1.2.27     -&gt; 1.2.27
Updating c547e0d..5cab93f
Fast-forward
 billboard.php                           |  109 ++++++++++++++-
 classes/view_gettingstarted.php         |  107 ++++++++++++++
 classes/view_gettingstarted_content.php |   38 +++++
 css/admin.css                           |   26 ++++
 history.txt                             |   22 +++-
 js/admin.js                             |   17 +++
 lib/updater/get.php                     |   94 +++++++-----
 lib/updater/history.txt                 |    9 ++
 lib/updater/updater.php                 |  241 ++++++++++++++++++-------------
 9 files changed, 519 insertions(+), 144 deletions(-)
 create mode 100644 classes/view_gettingstarted.php
 create mode 100644 classes/view_gettingstarted_content.php
 create mode 100644 css/admin.css
 create mode 100644 js/admin.js
 create mode 100644 lib/updater/history.txt
</code></pre></li>
<li><p>Now switch back to the root working directory of the repository. In our example, we are two directories in, so we run <code>cd ../..</code>.</p>
<pre><code>[user@office SampleTheme/lib/billboard]$ cd ../..
[user@office SampleTheme]$ 
</code></pre></li>
<li><p>Everything is now ready to be commit and pushed back in (if there is a remote repository to push to that is). If you run “git status“, you’ll notice that the path to the submodule is listed as modified. This is what you should expect to see. Simply add the path to be commit and do a commit. When you do the commit, the index will update the commit string for the submodule.</p>
<pre><code>[user@office SampleTheme]$ git status
# On branch master
# Changed but not updated:
#   (use &quot;git add ...&quot; to update what will be committed)
#   (use &quot;git checkout -- ...&quot; to discard changes in working directory)
#
#    modified:   lib/billboard (new commits)
#
no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
[user@office SampleTheme]$ git add lib/billboard
[user@office SampleTheme]$ git status
# On branch master
# Changes to be committed:
#   (use &quot;git reset HEAD ...&quot; to unstage)
#
#    modified:   lib/billboard
#
</code></pre></li>
</ol>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ol>
<li><a href="https://chrisjean.com/git-submodules-adding-using-removing-and-updating/" target="_blank" rel="external">Git Submodules: Adding, Using, Removing, Updating</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



    	
 
<nav id="pagination">
  
    <a href="/hexo_blog/page/2/" class="alignleft prev">上一页</a>
  
  
    <a href="/hexo_blog/page/4/" class="alignright next">下一页</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
        <aside id="sidebar" class="alignright">

   <div class="search">
  <form action="//baidu.com/s" method="get" accept-charset="utf-8">
    <input type="search" name="wd"results="0" placeholder="搜索">
    <input type="hidden" name="wd" value="site:ywlbupt.github.com/hexo_blog">
  </form>
</div> 


  
<div class="widget tag">
  <h3 class="title" id="categories">分类</h3>
<!--   
	
		<li><a class = "list-2"href="/hexo_blog/categories/Python/Basic/">Basic</a><small>1</small></li>
     
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Ubuntu/Cmd/">Cmd</a><small>2</small></li>
     
  
	
		<li><a href="/hexo_blog/categories/Diary/">Diary</a><small>0</small></li>
	
  
	
		<li><a href="/hexo_blog/categories/Gallery/">Gallery</a><small>0</small></li>
	
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Markdown/Hexo/">Hexo</a><small>3</small></li>
     
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Ubuntu/IDE-Config/">IDE_Config</a><small>1</small></li>
     
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Python/Lib/">Lib</a><small>3</small></li>
     
  
	
		<li><a href="/hexo_blog/categories/Markdown/">Markdown</a><small>3</small></li>
	
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Vim/Plugin/">Plugin</a><small>2</small></li>
     
  
	
		<li><a href="/hexo_blog/categories/Python/">Python</a><small>7</small></li>
	
  
	
		<li><a class = "list-2"href="/hexo_blog/categories/Python/Python-Basic/">Python_Basic</a><small>3</small></li>
     
  
	
		<li><a href="/hexo_blog/categories/Ubuntu/">Ubuntu</a><small>3</small></li>
	
  
	
		<li><a href="/hexo_blog/categories/Vim/">Vim</a><small>3</small></li>
	
   -->


     <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Markdown/">Markdown</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Markdown/Hexo/">Hexo</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Python/">Python</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Python/Basic/">Basic</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Python/Lib/">Lib</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Python/Python-Basic/">Python_Basic</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Ubuntu/">Ubuntu</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Ubuntu/Cmd/">Cmd</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Ubuntu/IDE-Config/">IDE_Config</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Vim/">Vim</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/hexo_blog/categories/Vim/Plugin/">Plugin</a><span class="category-list-count">2</span></li></ul></li></ul> 
</div>
 


  <div class="widget tag">
  <h3 class="title">日历云</h3>
  <div id="calendar"></div>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/hexo_blog/tags/deb/" style="font-size: 10px;">deb</a> <a href="/hexo_blog/tags/ejs引擎/" style="font-size: 10px;">ejs引擎</a> <a href="/hexo_blog/tags/find/" style="font-size: 10px;">find</a> <a href="/hexo_blog/tags/git/" style="font-size: 16.67px;">git</a> <a href="/hexo_blog/tags/grep/" style="font-size: 10px;">grep</a> <a href="/hexo_blog/tags/hexo/" style="font-size: 13.33px;">hexo</a> <a href="/hexo_blog/tags/jacman/" style="font-size: 13.33px;">jacman</a> <a href="/hexo_blog/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/hexo_blog/tags/json/" style="font-size: 10px;">json</a> <a href="/hexo_blog/tags/os/" style="font-size: 10px;">os</a> <a href="/hexo_blog/tags/python/" style="font-size: 20px;">python</a> <a href="/hexo_blog/tags/snippets/" style="font-size: 10px;">snippets</a> <a href="/hexo_blog/tags/tutorial/" style="font-size: 10px;">tutorial</a> <a href="/hexo_blog/tags/vim/" style="font-size: 13.33px;">vim</a> <a href="/hexo_blog/tags/yaml/" style="font-size: 10px;">yaml</a> <a href="/hexo_blog/tags/zt/" style="font-size: 10px;">zt</a>
  </div>
</div>


</aside>

      <div class="clearfix"></div>
    </div>
  
  <footer id="footer"><div class="footer-content inner">
  <div class="alignleft">
  
    &copy; 2016 Wlin
    
  </div>
  <div class="alignright">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme
    <a href="https://github.com/pengloo53/Hexo-theme-light_cn">light_cn</a>
  </div>
  
  <div class="visit">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
  </div>
  
  <div class="clearfix"></div>
</div></footer>
  <script src="http://libs.baidu.com/jquery/2.1.1/jquery.min.js"></script>
<script src="/hexo_blog/js/jquery.imagesloaded.min.js"></script>
<script src="/hexo_blog/js/gallery.js"></script>

<!-- add calendar widget -->

  <script src="/hexo_blog/js/calendar.js"></script>
  <script src="/hexo_blog/js/languages.js"></script>
  <script type="text/javascript">
    $(function() {
    
      $('#calendar').aCalendar('zh-CN',{single:undefined, root:'calendar'});
    
    });
  </script>


<!-- 添加『不蒜子』计数服务 -->
<script async src="http://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<div id="toTop">
	<a href="#">▲</a>
	<a href="#footer">▼</a>
</div>


<!-- 目录与分类的切换按钮 -->
<script type="text/javascript">
$(document).ready(function(){ 
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#sidebar'),
      c = $('.closeaside'),
      o = $('.openaside');
      t = $('#toc.toc-aside')
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    // t.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    t.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>



</body>
</html>


